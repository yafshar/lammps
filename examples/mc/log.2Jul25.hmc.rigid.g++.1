LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-212-g4bf7191833)
# SPC/E water with hybrid mc/md via fix hmc, using its rigid option

units           real
boundary        p p p
atom_style      full

read_data       data.hmc.spce
Reading data file ...
  orthogonal box = (-1.2 -1.2 -1.2) to (1.2 1.2 1.2)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  3 atoms
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  1 = max angles/atom
  orthogonal box = (-1.2 -1.2 -1.2) to (1.2 1.2 1.2)
  1 by 1 by 1 MPI processor grid
  reading bonds ...
  2 bonds
  reading angles ...
  1 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     2 = max # of 1-2 neighbors
     1 = max # of 1-3 neighbors
     1 = max # of 1-4 neighbors
     2 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds
replicate       4 4 4
Replication is creating a 4x4x4 = 64 times larger system...
  orthogonal box = (-1.2 -1.2 -1.2) to (8.4 8.4 8.4)
  1 by 1 by 1 MPI processor grid
  192 atoms
  128 bonds
  64 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     2 = max # of 1-2 neighbors
     1 = max # of 1-3 neighbors
     1 = max # of 1-4 neighbors
     2 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  replicate CPU = 0.001 seconds

mass            1 15.9994
mass            2 1.00784

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check yes

pair_style      lj/cut/coul/long 9.0
pair_modify     tail yes mix arithmetic
kspace_style    pppm 1.0e-5

pair_coeff      1 1 0.1554015 3.166
pair_coeff      2 2 0 0

bond_style      harmonic
bond_coeff      1 554.1349 1.000

angle_style     harmonic
angle_coeff     1 45.7696 109.47

timestep        1.0

thermo          100
#dump            1 all atom 10 dump.hmc_rigid

fix             1 all rigid/small molecule
Fix rigid/small setup ...
  create bodies CPU = 0.000 seconds
  64 rigid bodies with 192 atoms
  0.95789707 = max distance from body owner to body atom

# equilibrate a bit
run             1000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:345)
  G vector (1/distance) = 0.3592552
  grid = 12 12 12
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0015096129
  estimated relative force accuracy = 4.5461544e-06
  using double precision KISS FFT
  3d grid and FFT values/proc = 6859 1728
Generated 1 of 1 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 2 2 2
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.35 | 15.35 | 15.35 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              2848.4636      151.27379      2999.7374      1031168.7    
       100   3.6679973e-06  2848.4638      151.27379      2999.7376      1031168.7    
       200   2603.1452      1863.3537      151.27379      3000.0816      879432.62    
       300   3933.41        1359.717       151.27379      3000.0338      745810.43    
       400   4071.428       1307.8978      151.27379      3000.463       725545.55    
       500   3729.1619      1438.1139      151.27379      3001.1099      731746.07    
       600   4046.97        1318.667       151.27379      3001.9734      726819.15    
       700   3877.0888      1384.2225      151.27379      3003.2182      743129.66    
       800   4069.8481      1312.5722      151.27379      3004.5394      721362.21    
       900   4215.1234      1258.4267      151.27379      3005.3898      719625.22    
      1000   4147.7791      1284.1721      151.27379      3005.6411      728032.19    
Loop time of 1.89424 on 1 procs for 1000 steps with 192 atoms

Performance: 45.612 ns/day, 0.526 hours/ns, 527.917 timesteps/s, 101.360 katom-step/s
100.0% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.1035     | 1.1035     | 1.1035     |   0.0 | 58.25
Bond    | 0.0034901  | 0.0034901  | 0.0034901  |   0.0 |  0.18
Kspace  | 0.23058    | 0.23058    | 0.23058    |   0.0 | 12.17
Neigh   | 0.35481    | 0.35481    | 0.35481    |   0.0 | 18.73
Comm    | 0.033497   | 0.033497   | 0.033497   |   0.0 |  1.77
Output  | 0.00024613 | 0.00024613 | 0.00024613 |   0.0 |  0.01
Modify  | 0.16223    | 0.16223    | 0.16223    |   0.0 |  8.56
Other   |            | 0.005912   |            |       |  0.31

Nlocal:            192 ave         192 max         192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           6646 ave        6646 max        6646 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         115909 ave      115909 max      115909 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 115909
Ave neighs/atom = 603.69271
Ave special neighs/atom = 2
Neighbor list builds = 123
Dangerous builds = 0

# start HMC run

timestep        3.0  # large timestep
fix             2 all hmc 200 654123 300.0 rigid 1

thermo_style    custom step temp pe ke etotal f_2 f_2[*]

run             5000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:345)
  G vector (1/distance) = 0.3592552
  grid = 12 12 12
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0015096129
  estimated relative force accuracy = 4.5461544e-06
  using double precision KISS FFT
  3d grid and FFT values/proc = 6859 1728
Generated 1 of 1 mixed pair_coeff terms from arithmetic mixing rule
Per MPI rank memory allocation (min/avg/max) = 18.48 | 18.48 | 18.48 Mbytes
   Step          Temp          PotEng         KinEng         TotEng          f_2           f_2[1]         f_2[2]         f_2[3]         f_2[4]         f_2[5]    
      1000   295.23964      1435.4459      111.76677      1547.2127      0              0              0              0              0              0            
      1100   1828.1993      844.07383      692.08837      1536.1622      0              0              0              0              0              0            
      1200   2152.0176      724.48318      814.67396      1539.1571      1              1              1             -710.96273      702.90719     -8.0555379    
      1300   1996.1041      794.38413      755.65091      1550.035       1              1              1             -710.96273      702.90719     -8.0555379    
      1400   280.71451      724.48318      106.26809      830.75127      0.5            1              2              42.491733     -22.87891       19.612822    
      1500   1077.8719      417.15744      408.0423       825.19974      0.5            1              2              42.491733     -22.87891       19.612822    
      1600   1020.0661      440.0577       386.15917      826.21687      0.66666667     2              3             -284.42548      279.89108     -4.5343997    
      1700   1082.2654      416.65803      409.70551      826.36354      0.66666667     2              3             -284.42548      279.89108     -4.5343997    
      1800   305.97484      440.0577       115.83071      555.88841      0.5            2              4              2.233197       0.36072886     2.5939259    
      1900   677.47469      295.50851      256.46677      551.97528      0.5            2              4              2.233197       0.36072886     2.5939259    
      2000   589.8798       329.80288      223.30659      553.10947      0.6            3              5             -110.25482      107.47588     -2.7789439    
      2100   685.85332      292.9705       259.63861      552.60911      0.6            3              5             -110.25482      107.47588     -2.7789439    
      2200   317.85229      329.80288      120.32708      450.12995      0.5            3              6             -23.235572      23.810739      0.57516678   
      2300   545.85942      241.59343      206.64211      448.23555      0.5            3              6             -23.235572      23.810739      0.57516678   
      2400   499.5012       259.23873      189.09261      448.33134      0.57142857     4              7             -70.564143      68.765533     -1.7986103    
      2500   555.78023      238.12939      210.39776      448.52716      0.57142857     4              7             -70.564143      68.765533     -1.7986103    
      2600   514.95685      253.58427      194.94355      448.52782      0.625          5              8             -5.6544648      5.8509378      0.19647306   
      2700   538.1556       244.52296      203.72573      448.24869      0.625          5              8             -5.6544648      5.8509378      0.19647306   
      2800   301.38261      253.58427      114.09227      367.67654      0.55555556     5              9             -4.972173       5.7126105      0.74043746   
      2900   441.96496      198.69672      167.31153      366.00824      0.55555556     5              9             -4.972173       5.7126105      0.74043746   
      3000   395.28977      217.32615      149.64203      366.96818      0.6            6              10            -36.258122      35.549764     -0.70835772   
      3100   418.16331      209.07506      158.30111      367.37616      0.6            6              10            -36.258122      35.549764     -0.70835772   
      3200   441.862        199.4393       167.27255      366.71185      0.63636364     7              11            -17.886844      17.630516     -0.25632778   
      3300   442.96988      199.07819      167.69195      366.77014      0.63636364     7              11            -17.886844      17.630516     -0.25632778   
      3400   441.87845      199.7454       167.27878      367.02417      0.66666667     8              12             0.30609479     0.0062258553   0.31232065   
      3500   457.38821      193.79861      173.1502       366.94881      0.66666667     8              12             0.30609479     0.0062258553   0.31232065   
      3600   325.31146      199.7454       123.15084      322.89624      0.61538462     8              13             11.806089     -11.106401      0.69968758   
      3700   410.69804      166.54994      155.47503      322.02498      0.61538462     8              13             11.806089     -11.106401      0.69968758   
      3800   407.16349      167.90836      154.13698      322.04534      0.64285714     9              14            -31.837036      30.986138     -0.85089791   
      3900   358.58195      187.02252      135.74582      322.76833      0.64285714     9              14            -31.837036      30.986138     -0.85089791   
      4000   368.9845       182.9691       139.68383      322.65293      0.66666667     10             15             15.060739     -14.453149      0.60759041   
      4100   381.61596      178.08451      144.46563      322.55014      0.66666667     10             15             15.060739     -14.453149      0.60759041   
      4200   391.13202      174.46076      148.06806      322.52882      0.6875         11             16            -8.5083407      8.3842319     -0.12410887   
      4300   396.6116       172.43588      150.14243      322.57831      0.6875         11             16            -8.5083407      8.3842319     -0.12410887   
      4400   387.03571      176.12364      146.51735      322.64099      0.70588235     12             17             1.6628757     -1.550712       0.11216368   
      4500   361.42507      186.01729      136.82211      322.83941      0.70588235     12             17             1.6628757     -1.550712       0.11216368   
      4600   367.02276      184.24573      138.94119      323.18692      0.72222222     13             18             8.1220965     -7.5761594      0.5459371    
      4700   360.78178      186.45958      136.57859      323.03817      0.72222222     13             18             8.1220965     -7.5761594      0.5459371    
      4800   395.035        173.61619      149.54559      323.16178      0.73684211     14             19            -10.629538      10.604393     -0.025144716  
      4900   404.98856      169.40616      153.31363      322.71979      0.73684211     14             19            -10.629538      10.604393     -0.025144716  
      5000   380.01055      179.30406      143.85789      323.16195      0.75           15             20             5.6878666     -5.6876988      0.00016785329
      5100   385.91483      177.50132      146.09303      323.59435      0.75           15             20             5.6878666     -5.6876988      0.00016785329
      5200   393.81255      174.29175      149.08281      323.37456      0.76190476     16             21            -5.0123087      5.2249237      0.21261506   
      5300   385.1559       177.36408      145.80573      323.1698       0.76190476     16             21            -5.0123087      5.2249237      0.21261506   
      5400   348.52136      191.61864      131.93725      323.55589      0.77272727     17             22             17.326892     -17.145563      0.18132853   
      5500   374.1778       181.97079      141.64982      323.62062      0.77272727     17             22             17.326892     -17.145563      0.18132853   
      5600   377.5746       180.83338      142.93573      323.76911      0.7826087      18             23            -10.785263      10.998479      0.21321609   
      5700   394.62526      174.1834       149.39047      323.57387      0.7826087      18             23            -10.785263      10.998479      0.21321609   
      5800   371.57961      182.94741      140.66624      323.61366      0.79166667     19             24             2.1140341     -2.2694822     -0.15544809   
      5900   407.61265      169.17999      154.30702      323.48701      0.79166667     19             24             2.1140341     -2.2694822     -0.15544809   
      6000   393.89196      174.87309      149.11287      323.98597      0.8            20             25            -8.0743201      8.4466301      0.37230994   
Loop time of 10.5359 on 1 procs for 5000 steps with 192 atoms

Performance: 123.008 ns/day, 0.195 hours/ns, 474.569 timesteps/s, 91.117 katom-step/s
100.0% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.1134     | 6.1134     | 6.1134     |   0.0 | 58.03
Bond    | 0.021329   | 0.021329   | 0.021329   |   0.0 |  0.20
Kspace  | 1.1987     | 1.1987     | 1.1987     |   0.0 | 11.38
Neigh   | 2.0478     | 2.0478     | 2.0478     |   0.0 | 19.44
Comm    | 0.17253    | 0.17253    | 0.17253    |   0.0 |  1.64
Output  | 0.0010764  | 0.0010764  | 0.0010764  |   0.0 |  0.01
Modify  | 0.95063    | 0.95063    | 0.95063    |   0.0 |  9.02
Other   |            | 0.03035    |            |       |  0.29

Nlocal:            192 ave         192 max         192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           6666 ave        6666 max        6666 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         116074 ave      116074 max      116074 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 116074
Ave neighs/atom = 604.55208
Ave special neighs/atom = 2
Neighbor list builds = 675
Dangerous builds = 0
Total wall time: 0:00:12
