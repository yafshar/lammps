LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-747-g3fabe8e766-modified)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
# GCMC for CO2 molecular fluid, rigid/small dynamics
# Rigid CO2 TraPPE model
# [Potoff and J.I. Siepmann, Vapor-liquid equilibria of
# mixtures containing alkanes, carbon dioxide and
# nitrogen AIChE J., 47,1676-1682 (2001)].

# variables available on command line

variable        mu index -8.1
variable        disp index 0.5
variable        temp index 338.0
variable        lbox index 10.0
variable        spacing index 5.0

# global model settings

units           real
atom_style      full
boundary        p p p
pair_style      lj/cut/coul/long  14
pair_modify     mix arithmetic tail yes
kspace_style    ewald 0.0001
bond_style      harmonic
angle_style     harmonic

# box, start molecules on simple cubic lattice

lattice         sc ${spacing}
lattice         sc 5.0
Lattice spacing in x,y,z = 5 5 5
region          box block 0 ${lbox} 0 ${lbox} 0 ${lbox} units box
region          box block 0 10.0 0 ${lbox} 0 ${lbox} units box
region          box block 0 10.0 0 10.0 0 ${lbox} units box
region          box block 0 10.0 0 10.0 0 10.0 units box
create_box      2 box                                       bond/types 1                                angle/types 1                               extra/bond/per/atom 2                       extra/angle/per/atom 1                      extra/special/per/atom 2
Created orthogonal box = (0 0 0) to (10 10 10)
  1 by 1 by 1 MPI processor grid
molecule        co2mol CO2.txt
Read molecule template co2mol:
# CO2 molecule file. TraPPE model.
  1 molecules
  0 fragments
  0 bodies
  3 atoms with max type 2
  2 bonds with max type 1
  1 angles with max type 1
  0 dihedrals with max type 0
  0 impropers with max type 0
create_atoms    0 box mol co2mol 464563 units box
Created 24 atoms
  using box units in orthogonal box = (0 0 0) to (10 10 10)
  create_atoms CPU = 0.002 seconds

# rigid CO2 TraPPE model

pair_coeff      1   1  0.053649   2.8
pair_coeff      2   2  0.156973   3.05
bond_coeff      1       0       1.16
angle_coeff     1       0       180

# masses

mass 1 12.0107
mass 2 15.9994

# MD settings

group           co2 type 1 2
24 atoms in group co2
neighbor        2.0 bin
neigh_modify    every 1 delay 10 check yes
velocity        all create ${temp} 54654
velocity        all create 338.0 54654
timestep        1.0

# rigid constraints with thermostat

fix             myrigid co2 rigid/small molecule mol co2mol
Fix rigid/small setup ...
  create bodies CPU = 0.000 seconds
  8 rigid bodies with 24 atoms
  1.16 = max distance from body owner to body atom

# dynamically update  fix rigid/nvt/small temperature ndof
fix_modify      myrigid dynamic/dof yes

# gcmc

variable        tfac equal 5.0/3.0 # (3 trans + 2 rot)/(3 trans)
fix             mygcmc co2 gcmc 100 100 0 0 54341 ${temp} ${mu} ${disp} mol                 co2mol tfac_insert ${tfac} group co2 rigid myrigid
fix             mygcmc co2 gcmc 100 100 0 0 54341 338.0 ${mu} ${disp} mol                 co2mol tfac_insert ${tfac} group co2 rigid myrigid
fix             mygcmc co2 gcmc 100 100 0 0 54341 338.0 -8.1 ${disp} mol                 co2mol tfac_insert ${tfac} group co2 rigid myrigid
fix             mygcmc co2 gcmc 100 100 0 0 54341 338.0 -8.1 0.5 mol                 co2mol tfac_insert ${tfac} group co2 rigid myrigid
fix             mygcmc co2 gcmc 100 100 0 0 54341 338.0 -8.1 0.5 mol                 co2mol tfac_insert 1.66666666666667 group co2 rigid myrigid

# atom counts

variable        carbon atom "type==1"
variable        oxygen atom "type==2"
group           carbon dynamic co2 var carbon
dynamic group carbon defined
group           oxygen dynamic co2 var oxygen
dynamic group oxygen defined
variable        nC equal count(carbon)
variable        nO equal count(oxygen)

# output

variable        tacc equal f_mygcmc[2]/(f_mygcmc[1]+0.1)
variable        iacc equal f_mygcmc[4]/(f_mygcmc[3]+0.1)
variable        dacc equal f_mygcmc[6]/(f_mygcmc[5]+0.1)
variable        racc equal f_mygcmc[8]/(f_mygcmc[7]+0.1)

# dynamically update default temperature ndof
compute_modify  thermo_temp dynamic/dof yes

thermo_style    custom step temp press pe ke density atoms v_iacc v_dacc v_tacc v_racc v_nC v_nO
thermo          1000

# run

run             20000
Ewald initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.16463644
  estimated absolute RMS force accuracy = 0.033206372
  estimated relative force accuracy = 0.0001
  KSpace vectors: actual max1d max3d = 16 2 62
                  kxmax kymax kzmax  = 2 2 2
Generated 1 of 1 mixed pair_coeff terms from arithmetic mixing rule
WARNING: Fix gcmc using full_energy option (src/MC/fix_gcmc.cpp:544)
0 atoms in group FixGCMC:gcmc_exclusion_group:mygcmc
0 atoms in group FixGCMC:rotation_gas_atoms:mygcmc
WARNING: Neighbor exclusions used with KSpace solver may give inconsistent Coulombic energies (src/neighbor.cpp:671)
Neighbor list info ...
  update: every = 1 steps, delay = 10 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 16
  ghost atom cutoff = 16
  binsize = 8, bins = 2 2 2
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 16.23 | 16.23 | 16.23 Mbytes
   Step          Temp          Press          PotEng         KinEng        Density        Atoms        v_iacc         v_dacc         v_tacc         v_racc          v_nC           v_nO     
         0   364.27579      4238.8638     -9.6809362      13.391989      0.5846359             24   0              0              0              0              8              16           
      1000   261.50951     -204.60972     -9.6459262      8.3147751      0.51155641            21   0.096366192    0.097590121    0              0              7              14           
      2000   479.39488      231.26661     -7.008929       10.479224      0.36539744            15   0.085531005    0.085453295    0              0              5              10           
      3000   318.30562     -433.20078     -7.368017       8.5392774      0.43847693            18   0.078556687    0.080101462    0              0              6              12           
      4000   357.37576     -185.42051     -16.451291      14.91377       0.65771539            27   0.082003877    0.08249082     0              0              9              18           
      5000   397.73596      1560.2024     -16.579282      18.574014      0.73079488            30   0.071678941    0.073138028    0              0              10             20           
      6000   439.12281      1378.5794     -27.216281      24.869892      0.87695385            36   0.067637015    0.067021883    0              0              12             24           
      7000   394.34069     -838.36998     -19.380063      18.415457      0.73079488            30   0.062462904    0.063256405    0              0              10             20           
      8000   493.77819     -103.13104     -14.023136      20.606026      0.65771539            27   0.0647072      0.065041059    0              0              9              18           
      9000   263.67062      672.93097     -18.720307      12.313248      0.73079488            30   0.063945668    0.064500235    0              0              10             20           
     10000   479.12943     -464.7806      -23.438968      24.75536       0.80387436            33   0.067842336    0.068359178    0              0              11             22           
     11000   324.16871      177.40662     -24.554474      16.748946      0.80387436            33   0.070603916    0.071401039    0              0              11             22           
     12000   342.58054     -273.62776     -30.03447       19.402183      0.87695385            36   0.066775756    0.067225761    0              0              12             24           
     13000   293.86469     -1074.6789     -27.428996      16.643142      0.87695385            36   0.063452357    0.063934452    0              0              12             24           
     14000   445.63956      458.50971     -23.067963      23.025026      0.80387436            33   0.062428172    0.062858705    0              0              11             22           
     15000   267.33755     -9.409495      -8.9343062      8.5000796      0.51155641            21   0.071881495    0.07305838     0              0              7              14           
     16000   329.01771     -218.13496     -8.0156279      8.8266537      0.43847693            18   0.080411628    0.081593141    0              0              6              12           
     17000   294.51982      390.9315      -6.9199497      7.9011688      0.43847693            18   0.090153296    0.091499864    0              0              6              12           
     18000   296.09139     -530.1433      -19.71414       13.827278      0.73079488            30   0.092870347    0.093351624    0              0              10             20           
     19000   435.11989     -38.222576     -7.8345577      11.673088      0.43847693            18   0.10319018     0.10396766     0              0              6              12           
     20000   453.60252      183.44303     -6.2297259      12.168927      0.43847693            18   0.11379162     0.1146083      0              0              6              12           
Loop time of 26.1869 on 1 procs for 20000 steps with 18 atoms

Performance: 65.987 ns/day, 0.364 hours/ns, 763.741 timesteps/s, 13.747 katom-step/s
99.5% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.1672     | 4.1672     | 4.1672     |   0.0 | 15.91
Bond    | 0.028771   | 0.028771   | 0.028771   |   0.0 |  0.11
Kspace  | 0.40296    | 0.40296    | 0.40296    |   0.0 |  1.54
Neigh   | 0.1455     | 0.1455     | 0.1455     |   0.0 |  0.56
Comm    | 0.5177     | 0.5177     | 0.5177     |   0.0 |  1.98
Output  | 0.001405   | 0.001405   | 0.001405   |   0.0 |  0.01
Modify  | 20.905     | 20.905     | 20.905     |   0.0 | 79.83
Other   |            | 0.01861    |            |       |  0.07

Nlocal:             18 ave          18 max          18 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           1444 ave        1444 max        1444 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2747 ave        2747 max        2747 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2747
Ave neighs/atom = 152.61111
Ave special neighs/atom = 2
Neighbor list builds = 20371
Dangerous builds = 0

Total wall time: 0:00:26
