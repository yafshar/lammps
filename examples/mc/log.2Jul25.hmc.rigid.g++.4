LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-212-g4bf7191833)
# SPC/E water with hybrid mc/md via fix hmc, using its rigid option

units           real
boundary        p p p
atom_style      full

read_data       data.hmc.spce
Reading data file ...
  orthogonal box = (-1.2 -1.2 -1.2) to (1.2 1.2 1.2)
  1 by 2 by 2 MPI processor grid
  reading atoms ...
  3 atoms
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  1 = max angles/atom
  orthogonal box = (-1.2 -1.2 -1.2) to (1.2 1.2 1.2)
  1 by 2 by 2 MPI processor grid
  reading bonds ...
  2 bonds
  reading angles ...
  1 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     2 = max # of 1-2 neighbors
     1 = max # of 1-3 neighbors
     1 = max # of 1-4 neighbors
     2 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds
replicate       4 4 4
Replication is creating a 4x4x4 = 64 times larger system...
  orthogonal box = (-1.2 -1.2 -1.2) to (8.4 8.4 8.4)
  1 by 2 by 2 MPI processor grid
  192 atoms
  128 bonds
  64 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     2 = max # of 1-2 neighbors
     1 = max # of 1-3 neighbors
     1 = max # of 1-4 neighbors
     2 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  replicate CPU = 0.001 seconds

mass            1 15.9994
mass            2 1.00784

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check yes

pair_style      lj/cut/coul/long 9.0
pair_modify     tail yes mix arithmetic
kspace_style    pppm 1.0e-5

pair_coeff      1 1 0.1554015 3.166
pair_coeff      2 2 0 0

bond_style      harmonic
bond_coeff      1 554.1349 1.000

angle_style     harmonic
angle_coeff     1 45.7696 109.47

timestep        1.0

thermo          100
#dump            1 all atom 10 dump.hmc_rigid

fix             1 all rigid/small molecule
Fix rigid/small setup ...
  create bodies CPU = 0.000 seconds
  64 rigid bodies with 192 atoms
  0.95789707 = max distance from body owner to body atom

# equilibrate a bit
run             1000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:345)
  G vector (1/distance) = 0.3592552
  grid = 12 12 12
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0015096129
  estimated relative force accuracy = 4.5461544e-06
  using double precision KISS FFT
  3d grid and FFT values/proc = 3211 432
Generated 1 of 1 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 2 2 2
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.22 | 13.22 | 13.22 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              2848.4636      151.27379      2999.7374      1031168.7    
       100   3.9322824e-07  2848.4637      151.27379      2999.7375      1031168.7    
       200   2735.0049      1812.5534      151.27379      2999.1985      886881.82    
       300   4027.9862      1323.6169      151.27379      2999.7367      719476.18    
       400   4051.3858      1315.1413      151.27379      3000.1194      720214.09    
       500   4034.3734      1322.9893      151.27379      3001.5271      710786.2     
       600   3738.7793      1436.0553      151.27379      3002.6921      746883.14    
       700   4170.6113      1273.4674      151.27379      3003.5798      727323.79    
       800   4044.6354      1321.6314      151.27379      3004.054       709226.16    
       900   4117.3782      1294.2672      151.27379      3004.2275      718560.56    
      1000   3553.1607      1510.5601      151.27379      3006.9286      773212.35    
Loop time of 1.28915 on 4 procs for 1000 steps with 192 atoms

Performance: 67.021 ns/day, 0.358 hours/ns, 775.708 timesteps/s, 148.936 katom-step/s
86.6% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24498    | 0.38144    | 0.5107     |  15.3 | 29.59
Bond    | 0.0013077  | 0.0013546  | 0.0014208  |   0.1 |  0.11
Kspace  | 0.1572     | 0.28639    | 0.42226    |  17.6 | 22.22
Neigh   | 0.13925    | 0.13937    | 0.13949    |   0.0 | 10.81
Comm    | 0.12393    | 0.12447    | 0.12509    |   0.1 |  9.66
Output  | 0.00020998 | 0.00025399 | 0.00036156 |   0.0 |  0.02
Modify  | 0.34558    | 0.34591    | 0.34629    |   0.0 | 26.83
Other   |            | 0.009941   |            |       |  0.77

Nlocal:             48 ave          54 max          41 min
Histogram: 1 0 0 0 0 1 1 0 0 1
Nghost:        4869.25 ave        4907 max        4833 min
Histogram: 1 0 0 1 0 1 0 0 0 1
Neighs:        28981.5 ave       33974 max       19591 min
Histogram: 1 0 0 0 0 0 1 0 0 2

Total # of neighbors = 115926
Ave neighs/atom = 603.78125
Ave special neighs/atom = 2
Neighbor list builds = 126
Dangerous builds = 0

# start HMC run

timestep        3.0  # large timestep
fix             2 all hmc 200 654123 300.0 rigid 1

thermo_style    custom step temp pe ke etotal f_2 f_2[*]

run             5000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:345)
  G vector (1/distance) = 0.3592552
  grid = 12 12 12
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0015096129
  estimated relative force accuracy = 4.5461544e-06
  using double precision KISS FFT
  3d grid and FFT values/proc = 3211 432
Generated 1 of 1 mixed pair_coeff terms from arithmetic mixing rule
Per MPI rank memory allocation (min/avg/max) = 16.08 | 16.08 | 16.09 Mbytes
   Step          Temp          PotEng         KinEng         TotEng          f_2           f_2[1]         f_2[2]         f_2[3]         f_2[4]         f_2[5]    
      1000   293.43701      1661.8338      111.08436      1772.9182      0              0              0              0              0              0            
      1100   2029.05        984.51475      768.12301      1752.6378      0              0              0              0              0              0            
      1200   2206.5668      929.0179       835.32426      1764.3422      1              1              1             -732.81594      724.2399      -8.5760416    
      1300   2204.0452      939.42469      834.36967      1773.7944      1              1              1             -732.81594      724.2399      -8.5760416    
      1400   277.96033      929.0179       105.22546      1034.2434      0.5            1              2             -75.695436      95.091347      19.395911    
      1500   1144.8022      594.06245      433.3796       1027.4421      0.5            1              2             -75.695436      95.091347      19.395911    
      1600   1221.7844      566.21675      462.52222      1028.739       0.66666667     2              3             -362.80116      357.29676     -5.5043969    
      1700   1301.7975      537.01324      492.81221      1029.8255      0.66666667     2              3             -362.80116      357.29676     -5.5043969    
      1800   317.69918      566.21675      120.26911      686.48586      0.5            2              4             -41.262352      44.635815      3.3734625    
      1900   878.40543      347.4432       332.53169      679.97489      0.5            2              4             -41.262352      44.635815      3.3734625    
      2000   772.94264      389.22601      292.60739      681.8334       0.6            3              5             -176.99073      172.33828     -4.6524582    
      2100   857.21215      357.07603      324.5087       681.58473      0.6            3              5             -176.99073      172.33828     -4.6524582    
      2200   319.54092      389.22601      120.96633      510.19234      0.5            3              6             -25.672856      26.252419      0.57956382   
      2300   603.88474      279.34037      228.60834      507.94871      0.5            3              6             -25.672856      26.252419      0.57956382   
      2400   556.58903      297.88159      210.70395      508.58554      0.57142857     4              7             -91.344419      89.737617     -1.6068023    
      2500   593.61335      283.73328      224.71998      508.45326      0.57142857     4              7             -91.344419      89.737617     -1.6068023    
      2600   280.28613      297.88159      106.10592      403.98751      0.5            4              8             -7.5297333      8.1417612      0.61202785   
      2700   503.72005      211.84304      190.68971      402.53275      0.5            4              8             -7.5297333      8.1417612      0.61202785   
      2800   414.58492      246.15272      156.94646      403.09918      0.55555556     5              9             -51.728868      50.840536     -0.88833218   
      2900   491.9873       216.417        186.24813      402.66513      0.55555556     5              9             -51.728868      50.840536     -0.88833218   
      3000   493.49579      215.65049      186.81919      402.46968      0.6            6              10            -30.502235      29.872729     -0.62950594   
      3100   440.01085      236.52899      166.57177      403.10076      0.6            6              10            -30.502235      29.872729     -0.62950594   
      3200   487.65226      217.76193      184.60704      402.36897      0.63636364     7              11             2.1114434     -2.2121462     -0.10070277   
      3300   480.35187      221.22355      181.84339      403.06694      0.63636364     7              11             2.1114434     -2.2121462     -0.10070277   
      3400   280.57316      217.76193      106.21458      323.97652      0.58333333     7              12             4.9106748     -4.0747776      0.83589713   
      3500   367.8877       184.27814      139.26863      323.54677      0.58333333     7              12             4.9106748     -4.0747776      0.83589713   
      3600   365.87996      184.74102      138.50857      323.24959      0.61538462     8              13            -33.020911      32.293985     -0.726926     
      3700   372.77602      182.11458      141.11916      323.23374      0.61538462     8              13            -33.020911      32.293985     -0.726926     
      3800   386.1644       177.01614      146.18751      323.20364      0.64285714     9              14            -7.7248859      7.6789381     -0.045947815  
      3900   393.91906      174.24567      149.12313      323.3688       0.64285714     9              14            -7.7248859      7.6789381     -0.045947815  
      4000   377.27204      180.39379      142.82119      323.21498      0.66666667     10             15             3.3776517     -3.3663171      0.011334595  
      4100   409.21812      168.20713      154.91479      323.12192      0.66666667     10             15             3.3776517     -3.3663171      0.011334595  
      4200   317.00887      180.39379      120.00779      300.40158      0.625          10             16            -3.525995       3.6392406      0.11324562   
      4300   317.60091      180.15385      120.23191      300.38576      0.625          10             16            -3.525995       3.6392406      0.11324562   
      4400   309.97216      183.25536      117.34395      300.59931      0.64705882     11             17             2.8615696     -2.6638363      0.1977333    
      4500   375.11783      158.03464      142.00568      300.04032      0.64705882     11             17             2.8615696     -2.6638363      0.1977333    
      4600   318.18002      179.83337      120.45114      300.28451      0.66666667     12             18            -3.4219893      3.1071919     -0.31479739   
      4700   353.56456      166.28098      133.84642      300.1274       0.66666667     12             18            -3.4219893      3.1071919     -0.31479739   
      4800   359.74769      163.80141      136.18712      299.98853      0.68421053     13             19            -16.031962      15.735976     -0.29598552   
      4900   347.58247      168.74454      131.58182      300.32636      0.68421053     13             19            -16.031962      15.735976     -0.29598552   
      5000   394.94636      150.88601      149.51203      300.39804      0.7            14             20            -12.915396      13.324909      0.40951296   
      5100   369.24318      160.71927      139.78176      300.50103      0.7            14             20            -12.915396      13.324909      0.40951296   
      5200   308.40261      184.04295      116.74978      300.79273      0.71428571     15             21             33.156937     -32.762249      0.3946881    
      5300   349.20707      168.62213      132.19683      300.81896      0.71428571     15             21             33.156937     -32.762249      0.3946881    
      5400   344.00324      170.84169      130.22686      301.06854      0.72727273     16             22            -13.201261      13.477075      0.2758145    
      5500   351.24745      167.47918      132.96925      300.44843      0.72727273     16             22            -13.201261      13.477075      0.2758145    
      5600   312.52807      182.36922      118.31152      300.68074      0.73913043     17             23             11.527532     -11.915332     -0.38780002   
      5700   349.56299      168.79724      132.33157      301.12881      0.73913043     17             23             11.527532     -11.915332     -0.38780002   
      5800   344.71596      170.30771      130.49666      300.80437      0.75           18             24            -12.061513      12.185141      0.12362861   
      5900   369.77919      160.81961      139.98467      300.80429      0.75           18             24            -12.061513      12.185141      0.12362861   
      6000   347.41556      169.23557      131.51863      300.7542       0.76           19             25            -1.0721384      1.0219679     -0.050170519  
Loop time of 7.21406 on 4 procs for 5000 steps with 192 atoms

Performance: 179.649 ns/day, 0.134 hours/ns, 693.091 timesteps/s, 133.073 katom-step/s
86.7% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.4215     | 2.1852     | 2.9793     |  37.4 | 30.29
Bond    | 0.010107   | 0.010251   | 0.010368   |   0.1 |  0.14
Kspace  | 0.81023    | 1.6045     | 2.3669     |  43.6 | 22.24
Neigh   | 0.84418    | 0.84489    | 0.8456     |   0.1 | 11.71
Comm    | 0.66421    | 0.66591    | 0.66779    |   0.2 |  9.23
Output  | 0.00097208 | 0.0011289  | 0.0015493  |   0.7 |  0.02
Modify  | 1.8534     | 1.8595     | 1.864      |   0.3 | 25.78
Other   |            | 0.04268    |            |       |  0.59

Nlocal:             48 ave          49 max          47 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Nghost:        4892.75 ave        4912 max        4880 min
Histogram: 1 0 1 1 0 0 0 0 0 1
Neighs:        29013.8 ave       39143 max       19477 min
Histogram: 1 0 0 0 2 0 0 0 0 1

Total # of neighbors = 116055
Ave neighs/atom = 604.45312
Ave special neighs/atom = 2
Neighbor list builds = 700
Dangerous builds = 0
Total wall time: 0:00:08
