LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-739-g2644e7f6fa-modified)
  using 1 OpenMP thread(s) per MPI task
# 250 butane system for drude polarizability example (Langevin)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane
Reading data file ...
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  2 by 1 by 2 MPI processor grid
  reading atoms ...
  4500 atoms
  scanning bonds ...
  5 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  9 = max dihedrals/atom
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  2 by 1 by 2 MPI processor grid
  reading bonds ...
  4250 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6750 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.5     
     5 = max # of 1-2 neighbors
     8 = max # of 1-3 neighbors
    12 = max # of 1-4 neighbors
    17 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.037 seconds

comm_modify vel yes

group gBUTANE molecule 1:250
4500 atoms in group gBUTANE
group gCORES type 1 2 3
3500 atoms in group gCORES
group gDRUDES type 4 5
1000 atoms in group gDRUDES

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4
Finding SHAKE clusters ...
       0 = # of size 2 clusters
     500 = # of size 3 clusters
     500 = # of size 4 clusters
       0 = # of frozen angles
  find clusters CPU = 0.000 seconds

fix fLANG all langevin/drude ${vTEMP} 100.0 200611 ${vTEMP_D} 20.0 260514 zero yes
fix fLANG all langevin/drude 260 100.0 200611 ${vTEMP_D} 20.0 260514 zero yes
fix fLANG all langevin/drude 260 100.0 200611 1 20.0 260514 zero yes
fix fNPH all nve

compute cTEMP all temp/drude

thermo_style custom step etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.36786669
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.031353958
  estimated relative force accuracy = 9.4421513e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Generated 0 of 10 mixed pair_coeff terms from geometric mixing rule
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 17
New max number of 1-2 to 1-4 neighbors: 17 (+0)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
  (2) pair thole, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 17.33 | 17.61 | 17.71 Mbytes
   Step         TotEng         KinEng          Temp          PotEng         E_bond        E_angle        E_dihed        E_impro         E_vdwl         E_coul         E_long         Press          Volume       c_cTEMP[1]     c_cTEMP[2]  
         0   6535.5229      2714.74        248.45112      3820.783       3724.3278      140.75328      1.4735401      0             -518.77975      595169.42     -594696.41      4439.79        55742.797      334.61375      18.435655    
        50   3418.0025      2021.3092      184.98882      1396.6933      835.43668      808.13569      113.8069       0             -759.89264      595242.48     -594843.28      3040.8404      55742.797      197.07838      152.67751    
       100   2892.8438      1932.7675      176.88554      960.07632      363.31823      924.84568      164.52097      0             -931.84989      595306.3      -594867.05      1694.4339      55742.797      224.44681      49.878593    
       150   2833.9224      1947.7257      178.25451      886.19675      243.64601      972.03324      186.73658      0             -941.85404      595295.47     -594869.83      4603.7749      55742.797      239.63159      14.40403     
       200   2870.629       1920.2424      175.73925      950.38668      226.3737       1061.7175      186.27763      0             -950.17253      595296.43     -594870.24      2606.5046      55742.797      239.64552      5.1468096    
       250   2894.0911      1933.574       176.95935      960.51706      215.18825      1118.0957      195.43563      0             -993.951        595296.54     -594870.8       1812.6365      55742.797      242.261        2.6446652    
       300   2959.1218      1970.1936      180.31075      988.92823      209.63553      1155.4811      193.64322      0             -996.95108      595297.92     -594870.8       3371.5535      55742.797      247.17325      1.8304542    
       350   2988.7764      1988.8664      182.01968      999.91005      217.65998      1148.4029      204.96758      0             -996.55859      595296.05     -594870.61      3021.4003      55742.797      249.63956      1.5179763    
       400   3014.5639      1983.6589      181.54309      1030.905       225.81007      1174.5083      214.70195      0             -1012.492       595298.89     -594870.51      668.28852      55742.797      249.02833      1.4008901    
       450   3065.5273      2028.5299      185.64965      1036.9974      206.85827      1232.536       204.7453       0             -1034.5448      595297.52     -594870.12      1276.895       55742.797      254.65283      1.4568977    
       500   3087.3355      1998.9143      182.93925      1088.4212      209.84037      1244.2781      211.45123      0             -1004.5214      595297.9      -594870.53      1811.1354      55742.797      250.95893      1.3696218    
       550   3082.7522      2000.662       183.0992       1082.0902      218.46927      1229.7948      204.12764      0             -997.16039      595297.23     -594870.37      2005.0511      55742.797      251.16774      1.3999945    
       600   3089.1143      2008.9702      183.85956      1080.1441      215.63954      1239.6501      205.65591      0             -1008.3414      595297.61     -594870.07      1579.3913      55742.797      252.19306      1.4530426    
       650   3094.7605      1984.215       181.59398      1110.5455      217.2587       1270.5436      217.11566      0             -1021.7236      595297.37     -594870.02      922.17867      55742.797      249.09972      1.3970954    
       700   3085.7978      1977.7442      181.00178      1108.0536      226.89106      1263.0938      209.93618      0             -1019.8382      595298.21     -594870.24      1358.6745      55742.797      248.27152      1.4348065    
       750   3098.7075      1990.5214      182.17114      1108.1861      210.53962      1263.8112      208.67007      0             -1002.6807      595298.31     -594870.47      1389.4829      55742.797      249.86685      1.4670726    
       800   3106.7745      2001.1286      183.14191      1105.6458      223.39006      1267.3688      200.94768      0             -1014.1025      595298.4      -594870.36      498.96147      55742.797      251.20537      1.4561995    
       850   3162.1905      2015.7593      184.4809       1146.4311      238.914        1296.332       216.49568      0             -1033.2993      595298.07     -594870.08     -146.24972      55742.797      253.0624       1.412408     
       900   3151.6624      2017.7351      184.66172      1133.9272      225.66795      1259.6858      214.41346      0             -993.82625      595298.42     -594870.44      855.52676      55742.797      253.32946      1.3630812    
       950   3108.5578      1984.4638      181.61675      1124.094       219.09683      1258.9728      215.50095      0             -998.1116       595299.1      -594870.46      742.2965       55742.797      249.13227      1.3937461    
      1000   3151.143       2010.1072      183.96362      1141.0358      234.62671      1262.3296      218.15224      0             -1001.9318      595297.94     -594870.08     -15.429313      55742.797      252.317        1.5039712    
      1050   3154.9908      2025.2406      185.34862      1129.7501      240.28475      1245.2731      211.12129      0             -994.07986      595297.56     -594870.41      220.34496      55742.797      254.21034      1.5313364    
      1100   3146.7074      2015.0508      184.41606      1131.6566      217.69097      1255.7734      216.52885      0             -985.54351      595297.53     -594870.32      245.54843      55742.797      252.97306      1.4117208    
      1150   3184.3326      2097.0393      191.91959      1087.2933      210.06427      1226.6615      216.1572       0             -994.73546      595299.65     -594870.51      960.82094      55742.797      263.2934       1.3975168    
      1200   3181.1195      2062.3455      188.74444      1118.774       228.90519      1255.3357      202.92372      0             -997.73329      595299.52     -594870.18      341.31668      55742.797      258.91223      1.4415829    
      1250   3174.3642      2030.915       185.86794      1143.4492      239.32473      1267.7687      201.40959      0             -992.67809      595297.78     -594870.16      399.69634      55742.797      254.97195      1.4037212    
      1300   3181.4153      2020.4608      184.91117      1160.9546      213.94214      1283.8135      212.79413      0             -977.52419      595298.12     -594870.19      141.81218      55742.797      253.64069      1.4479069    
      1350   3221.4484      2077.8783      190.16599      1143.57        237.97091      1261.8857      206.43872      0             -991.01511      595298.43     -594870.14      293.81976      55742.797      260.85794      1.4643022    
      1400   3273.4088      2117.3717      193.78039      1156.0371      241.63836      1257.3077      215.03946      0             -986.42487      595298.6      -594870.13      881.28576      55742.797      265.82793      1.4598423    
      1450   3277.2166      2086.162       190.9241       1191.0546      245.42287      1289.0178      220.33443      0             -991.71404      595297.92     -594869.93      24.573765      55742.797      261.91753      1.417369     
      1500   3277.8654      2139.2816      195.78557      1138.5838      230.79458      1253.5267      210.70202      0             -984.94174      595298.66     -594870.16      612.24573      55742.797      268.59447      1.4327397    
      1550   3247.9908      2120.4401      194.06121      1127.5507      237.85254      1244.2412      207.38159      0             -989.02979      595297.17     -594870.07      908.40365      55742.797      266.20109      1.4941141    
      1600   3263.2074      2095.2606      191.7568       1167.9467      222.27474      1287.0827      217.80279      0             -988.01145      595299.17     -594870.37      372.09453      55742.797      263.06247      1.4165995    
      1650   3279.0078      2102.6706      192.43496      1176.3372      228.3594       1287.4322      218.78901      0             -987.87111      595299.94     -594870.32     -277.43156      55742.797      263.99608      1.4129203    
      1700   3297.4086      2103.744       192.5332       1193.6645      248.40927      1304.8648      202.53275      0             -989.52384      595297.12     -594869.74      1158.994       55742.797      264.11128      1.4656025    
      1750   3280.0386      2075.6968      189.96633      1204.3418      240.06417      1311.9499      213.18798      0             -987.79052      595296.49     -594869.56      437.82691      55742.797      260.6006       1.4183108    
      1800   3272.2424      2082.8408      190.62015      1189.4016      235.68336      1306.7314      216.11468      0             -997.06562      595297.79     -594869.86      1293.8957      55742.797      261.4994       1.4182004    
      1850   3288.865       2088.0432      191.09627      1200.8218      239.22801      1297.8735      214.15008      0             -979.04118      595298.01     -594869.39      217.43448      55742.797      262.1524       1.4245985    
      1900   3213.0029      2032.3821      186.00221      1180.6207      222.35814      1278.9262      222.52721      0             -969.80617      595296.01     -594869.39      563.17196      55742.797      255.16079      1.3933226    
      1950   3228.1809      2084.1563      190.74054      1144.0247      232.43887      1247.3331      216.54399      0             -981.18341      595298.59     -594869.7      -309.07402      55742.797      261.65441      1.4460789    
      2000   3297.5129      2091.6174      191.42338      1205.8955      238.75392      1287.2933      220.47141      0             -968.78471      595297.97     -594869.81      128.8881       55742.797      262.59806      1.4363676    
Loop time of 8.27806 on 4 procs for 2000 steps with 4500 atoms

Performance: 10.437 ns/day, 2.299 hours/ns, 241.602 timesteps/s, 1.087 Matom-step/s
99.1% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.3506     | 4.5626     | 4.7462     |   7.5 | 55.12
Bond    | 0.43274    | 0.47974    | 0.51414    |   4.4 |  5.80
Kspace  | 2.3226     | 2.5018     | 2.7371     |  10.7 | 30.22
Neigh   | 0.13014    | 0.13033    | 0.13053    |   0.0 |  1.57
Comm    | 0.18926    | 0.20031    | 0.22006    |   2.6 |  2.42
Output  | 0.0011407  | 0.0012819  | 0.0015827  |   0.5 |  0.02
Modify  | 0.38154    | 0.38207    | 0.38305    |   0.1 |  4.62
Other   |            | 0.01988    |            |       |  0.24

Nlocal:           1125 ave        1207 max        1003 min
Histogram: 1 0 0 0 0 1 0 0 1 1
Nghost:           5763 ave        5904 max        5656 min
Histogram: 2 0 0 0 0 0 1 0 0 1
Neighs:         214633 ave      220347 max      204542 min
Histogram: 1 0 0 0 0 0 1 0 1 1

Total # of neighbors = 858532
Ave neighs/atom = 190.78489
Ave special neighs/atom = 13.333333
Neighbor list builds = 28
Dangerous builds = 0
Total wall time: 0:00:08
