LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-739-g2644e7f6fa-modified)
  using 1 OpenMP thread(s) per MPI task
# 250 butane system for drude polarizability example (Langevin)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane
Reading data file ...
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  4500 atoms
  scanning bonds ...
  5 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  9 = max dihedrals/atom
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  1 by 1 by 1 MPI processor grid
  reading bonds ...
  4250 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6750 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.5     
     5 = max # of 1-2 neighbors
     8 = max # of 1-3 neighbors
    12 = max # of 1-4 neighbors
    17 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_data CPU = 0.034 seconds

comm_modify vel yes

group gBUTANE molecule 1:250
4500 atoms in group gBUTANE
group gCORES type 1 2 3
3500 atoms in group gCORES
group gDRUDES type 4 5
1000 atoms in group gDRUDES

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4
Finding SHAKE clusters ...
       0 = # of size 2 clusters
     500 = # of size 3 clusters
     500 = # of size 4 clusters
       0 = # of frozen angles
  find clusters CPU = 0.002 seconds

fix fNVT all tgnvt/drude temp ${vTEMP} ${vTEMP} 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 ${vTEMP} 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 260 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 260 100.0 1 20.0

compute cTEMP all temp/drude

thermo_style custom step etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2] f_fNVT[1] f_fNVT[2] f_fNVT[3]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.36786669
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.031353958
  estimated relative force accuracy = 9.4421513e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 79507 46656
Generated 0 of 10 mixed pair_coeff terms from geometric mixing rule
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 17
New max number of 1-2 to 1-4 neighbors: 17 (+0)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
  (2) pair thole, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
TGNHC thermostat for Drude model
  DOFs of molecules, atoms and dipoles: 747.0 7250.0 3000.0
Per MPI rank memory allocation (min/avg/max) = 26.74 | 26.74 | 26.74 Mbytes
   Step         TotEng         KinEng          Temp          PotEng         E_bond        E_angle        E_dihed        E_impro         E_vdwl         E_coul         E_long         Press          Volume       c_cTEMP[1]     c_cTEMP[2]     f_fNVT[1]      f_fNVT[2]      f_fNVT[3]   
         0   6535.5229      2714.74        248.45112      3820.783       3724.3278      140.75328      1.4735401      0             -518.77975      595169.42     -594696.41      4439.79        55742.797      334.61375      18.435655      235.53872      344.96036      18.435655    
        50   2088.2824      1463.7181      133.95847      624.5643       190.24601      660.52156      113.41252      0             -767.94561      595300.94     -594872.61      2824.2628      55742.797      183.94884      0.51687368     309.18565      171.12124      0.51687368   
       100   2119.7412      1619.097       148.17863      500.64427      180.00041      696.41213      164.28885      0             -972.75524      595305.17     -594872.47      1212.6142      55742.797      203.63725      0.14080734     399.49069      183.54186      0.14080734   
       150   2141.3841      1671.6283      152.98627      469.75574      135.16379      703.87431      168.6738       0             -966.11417      595300.45     -594872.29      4391.1693      55742.797      210.25781      0.10918071     418.15558      188.92417      0.10918071   
       200   2171.9504      1663.8326      152.27281      508.11774      189.68939      718.42617      166.2915       0             -990.53041      595295.36     -594871.12      2071.4055      55742.797      209.24314      0.19965125     435.49843      186.01763      0.19965125   
       250   2208.7061      1678.7069      153.6341       529.99919      152.5639       831.36871      167.05009      0             -1047.6813      595297.24     -594870.54      1092.237       55742.797      210.84693      0.9128973      438.53468      187.47449      0.9128973    
       300   2251.9249      1764.9742      161.52921      486.95073      145.17237      805.81497      155.39024      0             -1045.9572      595297.21     -594870.68      2438.7796      55742.797      220.85043      3.1777814      427.70755      199.6284       3.1777814    
       350   2270.9633      1684.9305      154.20368      586.03275      186.29541      828.98433      164.45538      0             -1016.9035      595293.56     -594870.36      2804.0927      55742.797      211.53678      1.1611962      408.91357      191.2877       1.1611962    
       400   2299.2362      1742.1505      159.44041      557.08574      171.75437      844.9778       181.89642      0             -1068.3059      595296.85     -594870.09      346.86979      55742.797      219.02792      0.38093963     392.66375      201.22807      0.38093963   
       450   2335.9623      1666.2461      152.49369      669.71616      137.89561      986.46036      179.5958       0             -1060.189       595295.82     -594869.86     -125.83607      55742.797      209.50259      0.31748121     376.15784      192.41804      0.31748121   
       500   2377.923       1744.8977      159.69183      633.02531      192.86616      865.11331      173.23165      0             -1020.1061      595291.45     -594869.53      3306.7533      55742.797      219.29509      0.59010513     361.05703      204.77946      0.59010513   
       550   2428.1814      1631.766       149.33809      796.41543      183.7528       1043.9175      175.64603      0             -1030.3844      595293.08     -594869.6       1566.0358      55742.797      204.67411      1.6260357      344.40558      190.36164      1.6260357    
       600   2475.0302      1615.769       147.87406      859.26125      195.35947      1102.8743      185.82439      0             -1049.7179      595293.93     -594869         751.07536      55742.797      202.5711       1.8674097      324.56808      190.08502      1.8674097    
       650   2516.5447      1706.6032      156.18715      809.94146      177.34487      1029.3218      186.91497      0             -1005.4619      595290.9      -594869.08      2456.1339      55742.797      214.42465      0.73094581     306.6687       205.00906      0.73094581   
       700   2566.0673      1658.8261      151.81461      907.24124      186.9752       1088.6916      184.51371      0             -976.01188      595292.41     -594869.33      403.90914      55742.797      208.52534      0.43420382     292.04617      200.0061       0.43420382   
       750   2621.7886      1798.1046      164.56129      823.68405      181.39692      1029.9425      187.40871      0             -1005.4401      595300.06     -594869.68      93.34564       55742.797      226.01978      0.50741639     278.62959      220.69268      0.50741639   
       800   2682.2117      1697.0698      155.31466      985.14185      215.09189      1113.1133      201.7849       0             -975.13207      595300.04     -594869.76     -978.97767      55742.797      213.08116      1.1153179      269.4557       207.36081      1.1153179    
       850   2745.8301      1887.0669      172.70305      858.76328      213.2538       980.55093      184.54852      0             -948.21116      595298.22     -594869.6      -1842.9663      55742.797      236.69144      1.8946536      265.28903      233.84284      1.8946536    
       900   2799.3197      1855.1337      169.78055      944.18599      201.04161      1103.4607      183.66453      0             -978.27383      595303.89     -594869.59     -1771.6561      55742.797      232.95614      1.142547       262.10905      230.04878      1.142547     
       950   2852.888       1809.5898      165.61241      1043.2982      249.19263      1129.6517      191.57063      0             -961.04128      595303.8      -594869.88     -2342.9015      55742.797      227.44426      0.56184997     253.71621      224.83146      0.56184997   
      1000   2910.6561      1900.2429      173.90891      1010.4132      196.79041      1117.444       178.94626      0             -911.75163      595298.72     -594869.74     -30.452223      55742.797      238.87601      0.48940588     245.53212      238.28905      0.48940588   
      1050   2970.4732      1950.8452      178.54         1019.628       226.17997      1113.3408      186.50453      0             -935.79301      595298.24     -594868.85     -835.03845      55742.797      245.11923      0.81684165     243.27887      245.41028      0.81684165   
      1100   3032.1775      1913.2917      175.10313      1118.8858      252.39332      1183.7624      209.49499      0             -958.58153      595300.89     -594869.07     -2339.7573      55742.797      240.10628      1.586306       244.29244      239.77431      1.586306     
      1150   3088.7232      2015.1575      184.42582      1073.5657      215.84767      1132.2267      209.14833      0             -912.58909      595297.76     -594868.83      53.404474      55742.797      252.92986      1.5639578      247.65404      253.57811      1.5639578    
      1200   3137.9449      1895.1544      173.44322      1242.7905      238.97671      1266.308       207.46161      0             -898.18357      595297.09     -594868.86     -940.55577      55742.797      238.13438      0.75999943     245.4415       237.48003      0.75999943   
      1250   3187.5693      2117.7199      193.81226      1069.8494      181.35781      1173.5117      216.10465      0             -933.15441      595300.81     -594868.78     -1638.2274      55742.797      266.2142       0.54659269     243.60628      268.65376      0.54659269   
      1300   3238.1411      2050.9418      187.70078      1187.1993      249.20904      1196.3017      223.50049      0             -909.65883      595296.3      -594868.46     -1547.4576      55742.797      257.7671       0.66953183     252.14109      258.45344      0.66953183   
      1350   3288.0386      2035.6922      186.30514      1252.3464      218.31868      1254.4212      222.85462      0             -868.43715      595293.49     -594868.3       390.8998       55742.797      255.64259      1.2189829      257.21246      255.58662      1.2189829    
      1400   3334.0329      2200.7081      201.40729      1133.3248      203.59119      1213.127       225.86627      0             -936.79406      595295.53     -594868         1372.2527      55742.797      276.25409      1.6144014      265.70211      277.45562      1.6144014    
      1450   3365.7442      2053.5346      187.93807      1312.2095      229.27416      1349.3991      233.25573      0             -924.22263      595292.17     -594867.67     -836.48446      55742.797      257.94915      1.0539236      270.48128      256.76464      1.0539236    
      1500   3391.6804      2142.1337      196.04659      1249.5467      216.36805      1271.2901      236.65866      0             -894.89899      595287.51     -594867.38      1789.6906      55742.797      269.2522       0.63559335     274.68492      268.80386      0.63559335   
      1550   3411.9836      2115.0945      193.57199      1296.889       192.92664      1363.4023      230.98686      0             -914.70166      595291.47     -594867.19      2191.5939      55742.797      265.85131      0.63356977     272.59366      265.26662      0.63356977   
      1600   3424.9781      2002.6552      183.28161      1422.3229      261.62063      1419.7858      242.17942      0             -928.06063      595294.38     -594867.58     -1278.1341      55742.797      251.58673      0.95134808     265.94168      250.21178      0.95134808   
      1650   3429.9652      2102.858       192.45211      1327.1072      253.88883      1296.8157      239.01621      0             -888.25494      595293.11     -594867.47      948.14106      55742.797      263.99872      1.4686845      261.93754      264.32033      1.4686845    
      1700   3421.4644      2141.4799      195.98676      1279.9845      181.31279      1326.081       226.54235      0             -878.86602      595292.19     -594867.28      241.91487      55742.797      268.9294       1.2770461      262.79418      269.67282      1.2770461    
      1750   3402.5389      2090.1999      191.29365      1312.339       263.74005      1296.4267      228.60053      0             -905.54641      595296.37     -594867.25     -1707.3519      55742.797      262.65584      0.80317353     257.84535      263.26017      0.80317353   
      1800   3381.1597      2133.1762      195.22681      1247.9834      234.93717      1242.0337      231.34583      0             -887.78157      595295.05     -594867.6      -6.7686361      55742.797      268.11459      0.6641785      258.06154      269.26135      0.6641785    
      1850   3358.3371      2097.294       191.9429       1261.0431      207.32435      1269.9581      225.83246      0             -867.84597      595293.05     -594867.28      1032.2908      55742.797      263.5578       0.7778662      261.21887      263.90785      0.7778662    
      1900   3335.0564      2130.3184      194.96527      1204.738       244.2856       1208.9686      209.87191      0             -885.54682      595293.79     -594866.63     -302.58585      55742.797      267.53278      1.2569361      256.95123      268.73374      1.2569361    
      1950   3309.4983      2065.1421      189.00037      1244.3563      244.25307      1240.7985      222.92921      0             -891.58179      595294.86     -594866.9      -2000.0471      55742.797      259.29269      1.3651868      254.1913       259.9256       1.3651868    
      2000   3284.0741      2005.746       183.56449      1278.3281      226.17309      1236.5565      225.16489      0             -837.57862      595295.52     -594867.51      942.10086      55742.797      251.97109      0.9633103      250.45118      252.23196      0.9633103    
Loop time of 26.8171 on 1 procs for 2000 steps with 4500 atoms

Performance: 3.222 ns/day, 7.449 hours/ns, 74.579 timesteps/s, 335.606 katom-step/s
99.6% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 17.723     | 17.723     | 17.723     |   0.0 | 66.09
Bond    | 1.7947     | 1.7947     | 1.7947     |   0.0 |  6.69
Kspace  | 6.0506     | 6.0506     | 6.0506     |   0.0 | 22.56
Neigh   | 0.51406    | 0.51406    | 0.51406    |   0.0 |  1.92
Comm    | 0.11146    | 0.11146    | 0.11146    |   0.0 |  0.42
Output  | 0.0042846  | 0.0042846  | 0.0042846  |   0.0 |  0.02
Modify  | 0.59269    | 0.59269    | 0.59269    |   0.0 |  2.21
Other   |            | 0.02601    |            |       |  0.10

Nlocal:           4500 ave        4500 max        4500 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           9440 ave        9440 max        9440 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         811253 ave      811253 max      811253 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 811253
Ave neighs/atom = 180.27844
Ave special neighs/atom = 13.333333
Neighbor list builds = 31
Dangerous builds = 0
Total wall time: 0:00:26
