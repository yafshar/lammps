LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-584-g3e8807bee0-modified)
  using 1 OpenMP thread(s) per MPI task
# 250 butane system for drude polarizability example (Nose-Hoover)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane
Reading data file ...
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  4500 atoms
  scanning bonds ...
  5 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  9 = max dihedrals/atom
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  1 by 1 by 1 MPI processor grid
  reading bonds ...
  4250 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6750 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.5     
     5 = max # of 1-2 neighbors
     8 = max # of 1-3 neighbors
    12 = max # of 1-4 neighbors
    17 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.034 seconds

group gBUTANE molecule 1:250
4500 atoms in group gBUTANE
group gCORES type 1 2 3
3500 atoms in group gCORES
group gDRUDES type 4 5
1000 atoms in group gDRUDES

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4
Finding SHAKE clusters ...
       0 = # of size 2 clusters
     500 = # of size 3 clusters
     500 = # of size 4 clusters
       0 = # of frozen angles
  find clusters CPU = 0.000 seconds

comm_modify vel yes
compute cTEMP_CORE gCORES temp/com
compute cTEMP all temp/drude

fix fDIRECT all drude/transform/direct
fix fNVT1 gCORES nvt temp ${vTEMP} ${vTEMP} 100.0
fix fNVT1 gCORES nvt temp 260 ${vTEMP} 100.0
fix fNVT1 gCORES nvt temp 260 260 100.0
fix fNVT2 gDRUDES nvt temp ${vTEMP_D} ${vTEMP_D} 20.0
fix fNVT2 gDRUDES nvt temp 1 ${vTEMP_D} 20.0
fix fNVT2 gDRUDES nvt temp 1 1 20.0
fix fINVERSE all drude/transform/inverse

fix fMOMENTUM all momentum 100 linear 1 1 1

thermo_style custom step etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.36786669
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.031353958
  estimated relative force accuracy = 9.4421513e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 79507 46656
Generated 0 of 10 mixed pair_coeff terms from geometric mixing rule
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 17
New max number of 1-2 to 1-4 neighbors: 17 (+0)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
  (2) pair thole, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 26.74 | 26.74 | 26.74 Mbytes
   Step         TotEng         KinEng          Temp          PotEng         E_bond        E_angle        E_dihed        E_impro         E_vdwl         E_coul         E_long         Press          Volume       c_cTEMP[1]     c_cTEMP[2]  
         0   6535.5229      2714.74        248.45112      3820.783       3724.3278      140.75328      1.4735401      0             -518.77975      595169.42     -594696.41      4439.79        55742.797      334.61375      18.435655    
        50   2090.3467      1466.1274      134.17896      624.2193       190.60043      660.09649      113.3603       0             -768.0633       595300.82     -594872.6       2826.2298      55742.797      184.22006      0.60185015   
       100   2131.9775      1633.3979      149.48744      498.57959      179.65934      694.88742      164.06284      0             -972.81644      595305.26     -594872.47      1226.7893      55742.797      205.4291       0.16019588   
       150   2177.6381      1711.4959      156.63492      466.14211      134.74039      700.59919      168.27759      0             -965.58407      595300.38     -594872.27      4413.0229      55742.797      215.26856      0.12192194   
       200   2233.5215      1730.4556      158.3701       503.06595      188.43013      712.91893      165.88668      0             -988.51359      595295.4      -594871.06      2113.594       55742.797      217.61367      0.22886549   
       250   2297.3009      1773.2292      162.28471      524.07174      151.53585      821.13539      166.81417      0             -1042.1458      595297.16     -594870.43      1173.0582      55742.797      222.691        1.0389716    
       300   2368.3955      1891.828       173.13879      476.56754      142.49041      789.96855      154.5939       0             -1037.1885      595297.25     -594870.54      2520.9236      55742.797      236.85673      3.0511316    
       350   2414.4804      1843.9331      168.75548      570.54738      181.42268      808.6796       163.12794      0             -1005.9572      595293.4      -594870.13      2879.5973      55742.797      231.57282      1.0738223    
       400   2466.7103      1924.3089      176.11142      542.40135      167.48017      817.71905      181.25316      0             -1050.6474      595296.37     -594869.77      494.79666      55742.797      241.94266      0.38535014   
       450   2522.7873      1875.8855      171.67974      646.90186      133.40898      944.20907      180.31147      0             -1037.0957      595295.5      -594869.43      63.402448      55742.797      235.86638      0.34369086   
       500   2580.2774      1955.7507      178.98895      624.52667      185.08464      827.39299      175.04154      0             -984.94517      595290.88     -594868.93      3484.9211      55742.797      245.79118      0.67068335   
       550   2640.6832      1866.035       170.77823      774.6482       176.89583      988.92035      176.49761      0             -991.07215      595292.32     -594868.91      1773.3504      55742.797      234.10561      1.7344368    
       600   2690.8563      1876.0663      171.69629      814.78997      186.23943      1032.0131      182.30326      0             -1010.7649      595293.3      -594868.3       919.72228      55742.797      235.38014      1.7010063    
       650   2732.1822      1963.542       179.70201      768.64019      165.39208      949.23886      183.81873      0             -951.98443      595290.3      -594868.13      2658.9044      55742.797      246.76773      0.6803753    
       700   2775.7294      1921.9362      175.89427      853.79321      175.21238      987.66719      186.48679      0             -918.75396      595291.36     -594868.18      670.06349      55742.797      241.62282      0.44222445   
       750   2820.0747      2038.1503      186.53011      781.92437      168.58538      929.80573      193.62702      0             -939.93778      595298.09     -594868.25      398.7295       55742.797      256.20117      0.55406988   
       800   2865.9594      1943.5753      177.87467      922.38408      197.16024      1009.2236      201.50384      0             -914.81695      595297.54     -594868.23     -717.10732      55742.797      244.04519      1.2420619    
       850   2909.1135      2101.557       192.33304      807.55655      195.18904      876.12794      184.47424      0             -876.315        595296.17     -594868.09     -1403.425       55742.797      263.69791      1.8343787    
       900   2938.1373      2038.924       186.60091      899.21331      183.32678      989.01662      184.31263      0             -889.86013      595300.05     -594867.63     -1087.2734      55742.797      256.1273       1.0106164    
       950   2965.6941      2007.9419      183.76545      957.75218      227.45525      972.71518      206.37949      0             -880.42313      595299.46     -594867.83     -1848.7586      55742.797      252.40651      0.53885918   
      1000   2994.2324      2058.0185      188.34843      936.21382      170.68932      965.88101      205.36603      0             -833.14438      595294.87     -594867.44      327.63968      55742.797      258.71293      0.52143432   
      1050   3022.9503      2095.3849      191.76818      927.56546      203.90749      935.91394      205.08193      0             -845.07235      595294.32     -594866.59     -355.70185      55742.797      263.25608      0.9419908    
      1100   3051.1765      2047.7196      187.40588      1003.4569      212.39897      989.65702      227.20823      0             -856.11277      595297.04     -594866.74     -1402.0203      55742.797      256.9838       1.6773508    
      1150   3071.8161      2127.8634      194.74059      943.95272      188.38429      926.24289      223.28028      0             -821.63205      595294.06     -594866.38      550.31101      55742.797      267.1916       1.3431357    
      1200   3087.7695      2015.2952      184.43843      1072.4743      199.90936      1034.9533      215.15497      0             -804.43302      595293.38     -594866.49     -333.57519      55742.797      253.26774      0.70914744   
      1250   3102.5822      2176.9518      199.23312      925.63045      155.81512      956.83608      230.07331      0             -847.47704      595296.65     -594866.26     -932.6649       55742.797      273.66551      0.5475192    
      1300   3116.8402      2087.6051      191.05617      1029.2351      209.96221      974.81024      241.13574      0             -823.38385      595292.74     -594866.03     -825.75553      55742.797      262.34493      0.76175749   
      1350   3131.0793      2089.6521      191.24352      1041.4271      186.48197      998.11164      233.70981      0             -801.36948      595290.06     -594865.57      684.79353      55742.797      262.36794      1.3871331    
      1400   3138.9957      2186.2571      200.08474      952.7386       168.6036       957.20151      227.72031      0             -826.52241      595291.08     -594865.34      1796.7396      55742.797      274.4739       1.5135582    
      1450   3139.5791      2010.7387      184.02141      1128.8404      192.80165      1074.5204      245.37338      0             -807.31827      595288.01     -594864.55     -16.540581      55742.797      252.63147      0.87724162   
      1500   3143.899       2099.4525      192.14044      1044.4464      186.04053      980.83477      242.01436      0             -784.81221      595285        -594864.63      2343.876       55742.797      263.8914       0.612412     
      1550   3149.7315      2086.0629      190.91503      1063.6686      165.80576      1056.0896      230.89744      0             -813.37614      595289.09     -594864.84      2260.7513      55742.797      262.176        0.69485453   
      1600   3156.5365      2013.421       184.2669       1143.1155      210.65921      1098.2874      243.95726      0             -835.61816      595290.47     -594864.64     -838.57061      55742.797      252.86501      1.1543447    
      1650   3160.0063      2081.0791      190.45892      1078.9272      212.21985      1005.7477      250.37516      0             -813.72227      595289.15     -594864.85      796.16795      55742.797      261.2262       1.5557247    
      1700   3155.5611      2113.3816      193.41522      1042.1795      146.03424      1019.0919      249.77506      0             -798.16073      595290.58     -594865.14      359.66305      55742.797      265.47066      1.07398      
      1750   3151.7986      2063.5455      188.85425      1088.2531      224.89129      997.01833      247.37777      0             -807.87768      595291.82     -594864.98     -1081.3038      55742.797      259.3432       0.69488137   
      1800   3150.4301      2097.9202      192.0002       1052.5099      202.22672      974.4217       248.59935      0             -799.54056      595291.61     -594864.8       94.53119       55742.797      263.68358      0.65252443   
      1850   3153.4544      2106.643       192.79851      1046.8113      177.57404      971.72202      249.90348      0             -777.13197      595289.76     -594865.02      881.44169      55742.797      264.65214      0.99602934   
      1900   3159.2018      2092.269       191.48301      1066.9328      198.79084      969.41925      260.02386      0             -787.25272      595290.4      -594864.45      606.46017      55742.797      262.66086      1.4839237    
      1950   3164.5226      2059.5738      188.49077      1104.9488      214.12654      1000.4419      263.3967       0             -799.45085      595291.13     -594864.69     -1248.8476      55742.797      258.6307       1.2624706    
      2000   3171.3009      2080.1597      190.37478      1091.1411      179.22059      996.41169      248.42511      0             -760.0105       595292.03     -594864.94      940.59916      55742.797      261.40002      0.78376947   
Loop time of 27.4414 on 1 procs for 2000 steps with 4500 atoms

Performance: 3.149 ns/day, 7.623 hours/ns, 72.883 timesteps/s, 327.972 katom-step/s
99.7% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 17.9       | 17.9       | 17.9       |   0.0 | 65.23
Bond    | 1.8705     | 1.8705     | 1.8705     |   0.0 |  6.82
Kspace  | 5.6853     | 5.6853     | 5.6853     |   0.0 | 20.72
Neigh   | 0.5606     | 0.5606     | 0.5606     |   0.0 |  2.04
Comm    | 0.087108   | 0.087108   | 0.087108   |   0.0 |  0.32
Output  | 0.0022204  | 0.0022204  | 0.0022204  |   0.0 |  0.01
Modify  | 1.3131     | 1.3131     | 1.3131     |   0.0 |  4.79
Other   |            | 0.02261    |            |       |  0.08

Nlocal:           4500 ave        4500 max        4500 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          10103 ave       10103 max       10103 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         774427 ave      774427 max      774427 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 774427
Ave neighs/atom = 172.09489
Ave special neighs/atom = 13.333333
Neighbor list builds = 35
Dangerous builds = 0
Total wall time: 0:00:27
