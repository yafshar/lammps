LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-739-g2644e7f6fa-modified)
  using 1 OpenMP thread(s) per MPI task
# 250 butane system for drude polarizability example (Langevin)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane
Reading data file ...
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  2 by 1 by 2 MPI processor grid
  reading atoms ...
  4500 atoms
  scanning bonds ...
  5 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  9 = max dihedrals/atom
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  2 by 1 by 2 MPI processor grid
  reading bonds ...
  4250 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6750 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.5     
     5 = max # of 1-2 neighbors
     8 = max # of 1-3 neighbors
    12 = max # of 1-4 neighbors
    17 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.034 seconds

comm_modify vel yes

group gBUTANE molecule 1:250
4500 atoms in group gBUTANE
group gCORES type 1 2 3
3500 atoms in group gCORES
group gDRUDES type 4 5
1000 atoms in group gDRUDES

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4
Finding SHAKE clusters ...
       0 = # of size 2 clusters
     500 = # of size 3 clusters
     500 = # of size 4 clusters
       0 = # of frozen angles
  find clusters CPU = 0.000 seconds

fix fNVT all tgnvt/drude temp ${vTEMP} ${vTEMP} 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 ${vTEMP} 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 260 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 260 100.0 1 20.0

compute cTEMP all temp/drude

thermo_style custom step etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2] f_fNVT[1] f_fNVT[2] f_fNVT[3]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.36786669
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.031353958
  estimated relative force accuracy = 9.4421513e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Generated 0 of 10 mixed pair_coeff terms from geometric mixing rule
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 17
New max number of 1-2 to 1-4 neighbors: 17 (+0)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
  (2) pair thole, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
TGNHC thermostat for Drude model
  DOFs of molecules, atoms and dipoles: 747.0 7250.0 3000.0
Per MPI rank memory allocation (min/avg/max) = 17.33 | 17.61 | 17.71 Mbytes
   Step         TotEng         KinEng          Temp          PotEng         E_bond        E_angle        E_dihed        E_impro         E_vdwl         E_coul         E_long         Press          Volume       c_cTEMP[1]     c_cTEMP[2]     f_fNVT[1]      f_fNVT[2]      f_fNVT[3]   
         0   6535.5229      2714.74        248.45112      3820.783       3724.3278      140.75328      1.4735401      0             -518.77975      595169.42     -594696.41      4439.79        55742.797      334.61375      18.435655      235.53872      344.96036      18.435655    
        50   2088.3443      1463.7416      133.96062      624.60273      190.28731      660.54143      113.40785      0             -767.95453      595300.93     -594872.61      2824.0523      55742.797      183.9497       0.52468068     309.23594      171.11764      0.52468068   
       100   2119.7474      1619.1466      148.18318      500.60076      180.0129       696.37694      164.27735      0             -972.76956      595305.17     -594872.47      1212.1154      55742.797      203.64285      0.14251816     399.52877      183.54412      0.14251816   
       150   2141.3699      1671.6878      152.99171      469.68212      135.1764       703.84496      168.6598       0             -966.14516      595300.44     -594872.29      4390.752       55742.797      210.26485      0.11034178     418.18147      188.92927      0.11034178   
       200   2171.9549      1663.9057      152.2795       508.04915      189.69207      718.41363      166.26728      0             -990.56316      595295.36     -594871.12      2071.2795      55742.797      209.25133      0.20233247     435.53113      186.0233       0.20233247   
       250   2208.7757      1678.8339      153.64572      529.94182      152.6072       831.35366      166.99449      0             -1047.7147      595297.24     -594870.54      1092.0191      55742.797      210.85827      0.92526182     438.54341      187.4861       0.92526182   
       300   2251.8199      1764.844       161.5173       486.97596      145.12526      805.82892      155.36767      0             -1045.8941      595297.22     -594870.68      2440.3186      55742.797      220.83898      3.1684607      427.70242      199.61611      3.1684607    
       350   2270.8952      1684.8322      154.19468      586.06297      186.2626       828.98058      164.47014      0             -1016.8664      595293.58     -594870.36      2805.092       55742.797      211.52748      1.1519505      408.90783      191.27829      1.1519505    
       400   2299.1992      1742.2608      159.4505       556.93838      171.73982      844.94622      181.87017      0             -1068.3641      595296.84     -594870.09      346.42446      55742.797      219.04152      0.38166785     392.61871      201.24772      0.38166785   
       450   2335.9473      1666.1971      152.4892       669.75022      137.90861      986.43104      179.60301      0             -1060.1348      595295.81     -594869.87     -124.88673      55742.797      209.49545      0.32005848     376.1147       192.41461      0.32005848   
       500   2377.935       1744.9374      159.69546      632.99763      192.89659      865.0227       173.24205      0             -1020.057       595291.42     -594869.52      3307.69        55742.797      219.29743      0.59718673     361.06129      204.78161      0.59718673   
       550   2428.2195      1631.8271      149.34369      796.39237      183.78404      1043.8511      175.66576      0             -1030.3884      595293.08     -594869.6       1565.6459      55742.797      204.6776       1.637242       344.46071      190.35981      1.637242     
       600   2474.865       1615.6237      147.86076      859.24131      195.26625      1102.8383      185.89397      0             -1049.6659      595293.92     -594869.01      751.20105      55742.797      202.55856      1.8521128      324.58977      190.06895      1.8521128    
       650   2516.5107      1706.7483      156.20042      809.76243      177.33668      1029.1545      186.89226      0             -1005.4742      595290.93     -594869.08      2457.4726      55742.797      214.44458      0.72647079     306.69822      205.02801      0.72647079   
       700   2566.0309      1658.7538      151.808        907.27715      187.0133       1088.6084      184.61389      0             -976.00495      595292.38     -594869.33      403.14931      55742.797      208.51587      0.4354706      292.00328      200.00013      0.4354706    
       750   2621.8104      1798.0666      164.55781      823.74375      181.38065      1030.121       187.24748      0             -1005.3911      595300.06     -594869.68      92.553714      55742.797      226.01328      0.5120082      278.52415      220.69637      0.5120082    
       800   2682.2637      1697.1503      155.32202      985.11337      215.11038      1113.1057      201.61208      0             -974.97573      595300.02     -594869.76     -976.0227       55742.797      213.08709      1.1265127      269.37143      207.37604      1.1265127    
       850   2745.7953      1887.1133      172.70731      858.68201      213.20284      980.38607      184.58098      0             -948.10768      595298.22     -594869.6      -1838.8298      55742.797      236.69968      1.8882575      265.22856      233.85817      1.8882575    
       900   2799.2124      1855.3964      169.80459      943.81599      200.99552      1103.2168      183.64059      0             -978.26946      595303.83     -594869.59     -1773.6399      55742.797      232.99302      1.1323115      262.06591      230.09392      1.1323115    
       950   2852.9103      1809.6344      165.61649      1043.2759      249.23664      1129.5155      191.54181      0             -960.9583       595303.82     -594869.88     -2343.6586      55742.797      227.45039      0.56047245     253.6359       224.8465       0.56047245   
      1000   2910.7005      1900.5666      173.93854      1010.1339      196.76222      1117.2836      179.06967      0             -911.95274      595298.71     -594869.74     -33.374878      55742.797      238.91565      0.49230818     245.54919      238.33102      0.49230818   
      1050   2970.5931      1950.7545      178.5317       1019.8386      226.09407      1113.2802      186.61908      0             -935.5961       595298.29     -594868.85     -832.86806      55742.797      245.10466      0.82528083     243.25365      245.3968       0.82528083   
      1100   3032.2481      1914.0096      175.16883      1118.2385      252.42208      1183.4083      209.13756      0             -958.53106      595300.88     -594869.07     -2341.1203      55742.797      240.19372      1.5939619      244.28411      239.87166      1.5939619    
      1150   3088.694       2014.6009      184.37488      1074.0931      215.76485      1132.4574      209.01033      0             -912.0866       595297.78     -594868.83      59.295076      55742.797      252.86484      1.5506292      247.67436      253.50427      1.5506292    
      1200   3137.976       1895.5576      173.48012      1242.4184      239.0167       1266.2434      206.94823      0             -898.01417      595297.09     -594868.87     -935.85591      55742.797      238.18678      0.75584897     245.80181      237.50087      0.75584897   
      1250   3187.6012      2118.7575      193.90722      1068.8437      181.27835      1173.4283      215.72674      0             -933.61917      595300.82     -594868.79     -1641.4902      55742.797      266.34427      0.54783814     244.09531      268.74689      0.54783814   
      1300   3238.1345      2050.9129      187.69813      1187.2216      249.09837      1195.8579      223.95777      0             -909.52195      595296.29     -594868.46     -1548.7611      55742.797      257.76139      0.67507639     252.48982      258.4112       0.67507639   
      1350   3287.8996      2035.6487      186.30116      1252.2509      218.3511       1254.3487      223.3631       0             -868.93354      595293.43     -594868.31      385.63869      55742.797      255.63368      1.2281303      257.5142       255.5457       1.2281303    
      1400   3333.7696      2200.7259      201.40891      1133.0437      203.40274      1213.391       225.99067      0             -937.20506      595295.47     -594868.01      1368.2399      55742.797      276.25813      1.6095891      265.82236      277.44768      1.6095891    
      1450   3365.4324      2053.4687      187.93203      1311.9637      229.10614      1350.1009      232.99558      0             -924.67369      595292.11     -594867.67     -844.06433      55742.797      257.94454      1.0440821      270.14304      256.79441      1.0440821    
      1500   3391.3706      2141.7722      196.01351      1249.5984      216.21034      1271.1551      236.52441      0             -894.39875      595287.52     -594867.41      1800.4826      55742.797      269.20762      0.63415037     273.93129      268.83174      0.63415037   
      1550   3411.6895      2114.0336      193.47489      1297.6559      192.96558      1363.1667      231.27418      0             -913.98674      595291.45     -594867.21      2209.1639      55742.797      265.7165       0.63742855     271.92199      265.18682      0.63742855   
      1600   3424.7972      2003.2633      183.33727      1421.5339      261.67416      1419.1889      241.6636       0             -927.77626      595294.38     -594867.6      -1282.7894      55742.797      251.65939      0.96160051     265.79666      250.3069       0.96160051   
      1650   3429.9765      2104.4788      192.60044      1325.4977      253.75833      1296.7733      237.25035      0             -887.95787      595293.15     -594867.48      966.66154      55742.797      264.20216      1.4699357      262.83185      264.45267      1.4699357    
      1700   3421.4424      2141.3192      195.97205      1280.1233      180.56709      1326.1423      227.27182      0             -878.7589       595292.2      -594867.3       269.33519      55742.797      268.91333      1.2659793      264.2838       269.50161      1.2659793    
      1750   3402.6042      2089.4666      191.22654      1313.1375      263.71167      1295.937       229.85773      0             -905.40824      595296.3      -594867.26     -1711.6241      55742.797      262.56619      0.79625472     258.49739      263.09406      0.79625472   
      1800   3381.363       2132.4462      195.16         1248.9168      234.4561       1241.8125      232.65057      0             -887.43388      595295.06     -594867.63      6.1655875      55742.797      268.02304      0.66340881     257.61941      269.20588      0.66340881   
      1850   3358.9779      2090.2009      191.29374      1268.777       207.84893      1271.8514      229.07966      0             -865.66729      595292.95     -594867.29      1046.4508      55742.797      262.66204      0.7869966      260.47049      262.99653      0.7869966    
      1900   3336.4181      2129.6649      194.90546      1206.7533      244.28217      1211.1792      208.93979      0             -884.87038      595293.88     -594866.65     -289.14925      55742.797      267.44686      1.2668034      256.86894      268.64742      1.2668034    
      1950   3311.0374      2068.2388      189.28379      1242.7986      243.85891      1242.1314      220.07902      0             -891.04664      595294.68     -594866.91     -1991.656       55742.797      259.68596      1.3553642      254.54412      260.32321      1.3553642    
      2000   3285.8329      2003.2486      183.33592      1282.5843      227.01603      1237.0473      227.76993      0             -837.35248      595295.6      -594867.49      937.91184      55742.797      251.66         0.95504899     250.48794      251.8849       0.95504899   
Loop time of 8.08661 on 4 procs for 2000 steps with 4500 atoms

Performance: 10.684 ns/day, 2.246 hours/ns, 247.322 timesteps/s, 1.113 Matom-step/s
99.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.1953     | 4.4478     | 4.6458     |   8.1 | 55.00
Bond    | 0.44011    | 0.47999    | 0.51844    |   4.1 |  5.94
Kspace  | 2.3141     | 2.5339     | 2.805      |  11.4 | 31.33
Neigh   | 0.145      | 0.14515    | 0.14528    |   0.0 |  1.79
Comm    | 0.19512    | 0.20824    | 0.22575    |   2.5 |  2.58
Output  | 0.0016634  | 0.001772   | 0.0020406  |   0.4 |  0.02
Modify  | 0.24844    | 0.24985    | 0.2519     |   0.3 |  3.09
Other   |            | 0.01996    |            |       |  0.25

Nlocal:           1125 ave        1220 max        1043 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Nghost:         5813.5 ave        5907 max        5699 min
Histogram: 1 0 0 1 0 0 0 0 1 1
Neighs:         202807 ave      217353 max      190809 min
Histogram: 1 1 0 0 0 0 1 0 0 1

Total # of neighbors = 811227
Ave neighs/atom = 180.27267
Ave special neighs/atom = 13.333333
Neighbor list builds = 31
Dangerous builds = 0
Total wall time: 0:00:08
