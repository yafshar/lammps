LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-739-g2644e7f6fa-modified)
  using 1 OpenMP thread(s) per MPI task
# 250 butane system for drude polarizability example (Langevin)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane
Reading data file ...
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  4500 atoms
  scanning bonds ...
  5 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  9 = max dihedrals/atom
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  1 by 1 by 1 MPI processor grid
  reading bonds ...
  4250 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6750 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.5     
     5 = max # of 1-2 neighbors
     8 = max # of 1-3 neighbors
    12 = max # of 1-4 neighbors
    17 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_data CPU = 0.037 seconds

comm_modify vel yes

group gBUTANE molecule 1:250
4500 atoms in group gBUTANE
group gCORES type 1 2 3
3500 atoms in group gCORES
group gDRUDES type 4 5
1000 atoms in group gDRUDES

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4
Finding SHAKE clusters ...
       0 = # of size 2 clusters
     500 = # of size 3 clusters
     500 = # of size 4 clusters
       0 = # of frozen angles
  find clusters CPU = 0.001 seconds

fix fLANG all langevin/drude ${vTEMP} 100.0 200611 ${vTEMP_D} 20.0 260514 zero yes
fix fLANG all langevin/drude 260 100.0 200611 ${vTEMP_D} 20.0 260514 zero yes
fix fLANG all langevin/drude 260 100.0 200611 1 20.0 260514 zero yes
fix fNPH all nve

compute cTEMP all temp/drude

thermo_style custom step etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.36786669
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.031353958
  estimated relative force accuracy = 9.4421513e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 79507 46656
Generated 0 of 10 mixed pair_coeff terms from geometric mixing rule
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 17
New max number of 1-2 to 1-4 neighbors: 17 (+0)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
  (2) pair thole, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 26.74 | 26.74 | 26.74 Mbytes
   Step         TotEng         KinEng          Temp          PotEng         E_bond        E_angle        E_dihed        E_impro         E_vdwl         E_coul         E_long         Press          Volume       c_cTEMP[1]     c_cTEMP[2]  
         0   6535.5229      2714.74        248.45112      3820.783       3724.3278      140.75328      1.4735401      0             -518.77975      595169.42     -594696.41      4439.79        55742.797      334.61375      18.435655    
        50   3442.9214      2047.8425      187.41713      1395.0789      844.61101      802.43438      114.10967      0             -765.53199      595242.44     -594842.98      3027.4085      55742.797      200.4343       152.51724    
       100   2949.9137      1973.6229      180.6246       976.29074      358.0742       923.62857      174.43734      0             -919.88298      595306.76     -594866.72      2009.1058      55742.797      229.49985      50.109981    
       150   2885.0698      1951.4547      178.59578      933.61511      234.26452      991.10198      194.44106      0             -910.0334       595293.22     -594869.38      4963.8806      55742.797      240.13548      14.311317    
       200   2890.3426      1901.2801      174.00384      989.06257      227.57533      1077.5605      200.01467      0             -943.83326      595298.11     -594870.36      2977.5806      55742.797      237.27186      5.1150972    
       250   2922.3481      1945.2702      178.02978      977.07796      212.26144      1127.8726      194.65284      0             -984.29341      595297.59     -594871.01      1592.2364      55742.797      243.81864      2.4147816    
       300   2986.5744      2013.1589      184.24291      973.41544      212.85963      1130.6272      194.90599      0             -992.98724      595299.3      -594871.29      2816.8625      55742.797      252.63444      1.6812793    
       350   3051.4921      1978.4541      181.06675      1073.0381      228.4341       1195.4688      205.43169      0             -982.55178      595297.25     -594871         1408.7976      55742.797      248.34887      1.4666744    
       400   3011.3987      1995.0048      182.58145      1016.394       237.79955      1167.8185      197.49857      0             -1014.9362      595298.99     -594870.78      1456.5003      55742.797      250.45674      1.3981187    
       450   3010.2616      1976.9744      180.93133      1033.2871      216.34782      1196.7189      197.65964      0             -1005.6015      595298.72     -594870.56      1296.5276      55742.797      248.18689      1.4022273    
       500   3051.4556      2022.049       185.05652      1029.4066      220.84993      1196.1502      199.57249      0             -1014.3775      595298.27     -594871.05      2481.7568      55742.797      253.85835      1.3999256    
       550   3086.0025      2018.9226      184.7704       1067.0799      221.95877      1215.9767      213.34051      0             -1012.5564      595299.48     -594871.12      1694.9378      55742.797      253.47686      1.368394     
       600   3110.9929      2030.8992      185.86649      1080.0937      220.35725      1253.9571      208.13084      0             -1030.4314      595298.96     -594870.88     -76.102889      55742.797      254.95683      1.43974      
       650   3154.3731      2024.8469      185.31259      1129.5262      221.85971      1283.3519      210.69449      0             -1015.2311      595299.67     -594870.82      1280.5697      55742.797      254.20302      1.4194503    
       700   3133.8503      2054.2045      187.99938      1079.6457      225.19338      1242.7819      192.54091      0             -1010.8971      595301.2      -594871.18      696.8539       55742.797      257.8878       1.4422433    
       750   3189.0813      2103.7507      192.53381      1085.3306      219.46948      1243.7676      203.10695      0             -1010.2442      595299.93     -594870.7       483.46505      55742.797      264.14441      1.3796789    
       800   3173.6625      2053.4831      187.93336      1120.1794      219.59931      1256.272       218.7619       0             -1003.0066      595299.37     -594870.81      543.098        55742.797      257.81268      1.4005678    
       850   3221.2876      2083.5215      190.68244      1137.7662      224.04919      1276.9143      219.91998      0             -1011.193       595298.47     -594870.4       143.54962      55742.797      261.60038      1.3772619    
       900   3214.96        2053.8414      187.96614      1161.1187      222.21436      1296.0291      226.57611      0             -1013.6289      595300.61     -594870.68      473.39563      55742.797      257.85596      1.405314     
       950   3213.1086      2123.777       194.3666       1089.3316      221.79125      1251.6851      200.63799      0             -1014.089       595300.01     -594870.7       1206.8493      55742.797      266.62112      1.4935241    
      1000   3211.3105      2079.738       190.33618      1131.5725      225.47672      1260.2163      204.61249      0             -986.95686      595298.7      -594870.48      787.31487      55742.797      261.0928       1.4615273    
      1050   3199.3227      2095.9149      191.81668      1103.4078      212.62976      1255.417       208.36886      0             -1001.9238      595299.13     -594870.21      239.45511      55742.797      263.14174      1.4246897    
      1100   3199.8686      2067.6467      189.2296       1132.2219      235.50505      1264.2214      198.42441      0             -994.78565      595299.12     -594870.26      830.6752       55742.797      259.58627      1.422573     
      1150   3172.4668      2083.0987      190.64375      1089.3681      209.20041      1236.7214      204.50262      0             -990.26026      595299.43     -594870.22      1355.1407      55742.797      261.54263      1.3894326    
      1200   3178.2154      2055.1801      188.08866      1123.0353      230.76614      1258.2176      205.04891      0             -999.28825      595298.25     -594869.96      819.54381      55742.797      258.01926      1.4189862    
      1250   3224.5367      2108.1449      192.93596      1116.3918      235.56941      1247.0387      212.74771      0             -1007.3896      595298.16     -594869.74     -146.3801       55742.797      264.67477      1.4395396    
      1300   3286.0635      2125.3364      194.50931      1160.7272      236.69228      1272.7247      218.49151      0             -995.46845      595298.38     -594870.1       434.46542      55742.797      266.83295      1.4517724    
      1350   3247.1808      2087.4519      191.04215      1159.7289      215.07569      1301.2189      211.43765      0             -995.15129      595297.24     -594870.09      1501.3506      55742.797      262.07017      1.4430502    
      1400   3194.7719      2041.9251      186.87557      1152.8469      236.948        1261.0635      209.14661      0             -982.03995      595297.35     -594869.63      346.64903      55742.797      256.31352      1.520816     
      1450   3229.6087      2087.4546      191.0424       1142.1541      246.8536       1264.077       205.22435      0             -1003.5383      595299.44     -594869.9       278.15329      55742.797      262.08336      1.4087833    
      1500   3249.6603      2089.854       191.262        1159.8063      238.99336      1274.9502      206.61801      0             -988.99016      595297.98     -594869.75      636.34228      55742.797      262.36618      1.4595906    
      1550   3273.2217      2122.5464      194.25398      1150.6753      230.16427      1274.9964      195.76854      0             -979.24733      595298.84     -594869.85      528.01908      55742.797      266.47595      1.4678022    
      1600   3288.6784      2120.7284      194.0876       1167.9499      229.10282      1274.2494      205.30609      0             -969.94194      595298.85     -594869.62      1126.6573      55742.797      266.23416      1.5026919    
      1650   3286.3328      2148.1031      196.59291      1138.2297      234.18576      1256.201       214.69177      0             -995.41699      595298.38     -594869.81     -457.07342      55742.797      269.67988      1.4977184    
      1700   3296.9483      2092.8432      191.53556      1204.1051      238.05559      1313.8592      213.47965      0             -989.09877      595297.16     -594869.35      981.42401      55742.797      262.74231      1.4593706    
      1750   3310.3961      2097.6546      191.97589      1212.7416      243.5662       1309.6811      210.07119      0             -978.63735      595297.78     -594869.72     -41.878709      55742.797      263.31943      1.5344903    
      1800   3229.7419      2079.7566      190.33788      1149.9853      226.57582      1276.3941      202.6012       0             -984.26109      595298.62     -594869.94      515.98158      55742.797      261.07174      1.5239444    
      1850   3199.6374      2033.146       186.07211      1166.4914      242.84462      1267.7768      212.87755      0             -984.52177      595296.72     -594869.21      440.77208      55742.797      255.22288      1.4839965    
      1900   3155.3871      2019.0731      184.78417      1136.314       213.38107      1263.0106      213.00423      0             -980.43251      595296.92     -594869.57      469.76821      55742.797      253.48524      1.3965336    
      1950   3191.9371      2051.5474      187.75619      1140.3897      211.61608      1278.9441      206.10485      0             -984.04539      595297.56     -594869.79      758.07052      55742.797      257.54477      1.4655794    
      2000   3214.3942      2041.9357      186.87654      1172.4585      237.13202      1275.4193      218.0467       0             -985.25589      595296.76     -594869.64      375.81697      55742.797      256.33161      1.4761538    
Loop time of 27.7776 on 1 procs for 2000 steps with 4500 atoms

Performance: 3.110 ns/day, 7.716 hours/ns, 72.001 timesteps/s, 324.002 katom-step/s
99.6% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 18.316     | 18.316     | 18.316     |   0.0 | 65.94
Bond    | 1.7941     | 1.7941     | 1.7941     |   0.0 |  6.46
Kspace  | 6.1427     | 6.1427     | 6.1427     |   0.0 | 22.11
Neigh   | 0.46563    | 0.46563    | 0.46563    |   0.0 |  1.68
Comm    | 0.11655    | 0.11655    | 0.11655    |   0.0 |  0.42
Output  | 0.0025174  | 0.0025174  | 0.0025174  |   0.0 |  0.01
Modify  | 0.91411    | 0.91411    | 0.91411    |   0.0 |  3.29
Other   |            | 0.02592    |            |       |  0.09

Nlocal:           4500 ave        4500 max        4500 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           8703 ave        8703 max        8703 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         860806 ave      860806 max      860806 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 860806
Ave neighs/atom = 191.29022
Ave special neighs/atom = 13.333333
Neighbor list builds = 28
Dangerous builds = 0
Total wall time: 0:00:27
