LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-584-g3e8807bee0-modified)
  using 1 OpenMP thread(s) per MPI task
# 250 butane system for drude polarizability example (Nose-Hoover)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane
Reading data file ...
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  2 by 1 by 2 MPI processor grid
  reading atoms ...
  4500 atoms
  scanning bonds ...
  5 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  9 = max dihedrals/atom
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  2 by 1 by 2 MPI processor grid
  reading bonds ...
  4250 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6750 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.5     
     5 = max # of 1-2 neighbors
     8 = max # of 1-3 neighbors
    12 = max # of 1-4 neighbors
    17 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.035 seconds

group gBUTANE molecule 1:250
4500 atoms in group gBUTANE
group gCORES type 1 2 3
3500 atoms in group gCORES
group gDRUDES type 4 5
1000 atoms in group gDRUDES

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4
Finding SHAKE clusters ...
       0 = # of size 2 clusters
     500 = # of size 3 clusters
     500 = # of size 4 clusters
       0 = # of frozen angles
  find clusters CPU = 0.000 seconds

comm_modify vel yes
compute cTEMP_CORE gCORES temp/com
compute cTEMP all temp/drude

fix fDIRECT all drude/transform/direct
fix fNVT1 gCORES nvt temp ${vTEMP} ${vTEMP} 100.0
fix fNVT1 gCORES nvt temp 260 ${vTEMP} 100.0
fix fNVT1 gCORES nvt temp 260 260 100.0
fix fNVT2 gDRUDES nvt temp ${vTEMP_D} ${vTEMP_D} 20.0
fix fNVT2 gDRUDES nvt temp 1 ${vTEMP_D} 20.0
fix fNVT2 gDRUDES nvt temp 1 1 20.0
fix fINVERSE all drude/transform/inverse

fix fMOMENTUM all momentum 100 linear 1 1 1

thermo_style custom step etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.36786669
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.031353958
  estimated relative force accuracy = 9.4421513e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Generated 0 of 10 mixed pair_coeff terms from geometric mixing rule
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 17
New max number of 1-2 to 1-4 neighbors: 17 (+0)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
  (2) pair thole, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 17.33 | 17.61 | 17.71 Mbytes
   Step         TotEng         KinEng          Temp          PotEng         E_bond        E_angle        E_dihed        E_impro         E_vdwl         E_coul         E_long         Press          Volume       c_cTEMP[1]     c_cTEMP[2]  
         0   6535.5229      2714.74        248.45112      3820.783       3724.3278      140.75328      1.4735401      0             -518.77975      595169.42     -594696.41      4439.79        55742.797      334.61375      18.435655    
        50   2090.3467      1466.1274      134.17896      624.21932      190.60043      660.09649      113.3603       0             -768.0633       595300.82     -594872.6       2826.2298      55742.797      184.22006      0.60185015   
       100   2131.9774      1633.3979      149.48744      498.57957      179.65934      694.88742      164.06284      0             -972.81644      595305.26     -594872.47      1226.7892      55742.797      205.4291       0.16019587   
       150   2177.6381      1711.4959      156.63492      466.14212      134.74039      700.59919      168.27759      0             -965.58407      595300.38     -594872.27      4413.0228      55742.797      215.26856      0.12192193   
       200   2233.5217      1730.4556      158.3701       503.06615      188.43013      712.91893      165.88668      0             -988.51359      595295.4      -594871.06      2113.5942      55742.797      217.61367      0.22886535   
       250   2297.3011      1773.2292      162.28471      524.07198      151.53584      821.13539      166.81417      0             -1042.1458      595297.16     -594870.43      1173.0582      55742.797      222.691        1.0389712    
       300   2368.3956      1891.828       173.13879      476.56762      142.49043      789.96855      154.5939       0             -1037.1885      595297.25     -594870.54      2520.9235      55742.797      236.85673      3.0511318    
       350   2414.4806      1843.9331      168.75548      570.54751      181.42268      808.6796       163.12794      0             -1005.9572      595293.4      -594870.13      2879.5976      55742.797      231.57281      1.0738227    
       400   2466.7097      1924.3089      176.11142      542.40081      167.48017      817.71905      181.25316      0             -1050.6474      595296.37     -594869.77      494.79673      55742.797      241.94266      0.38535034   
       450   2522.787       1875.8855      171.67974      646.90152      133.40898      944.20906      180.31147      0             -1037.0957      595295.5      -594869.43      63.402043      55742.797      235.86638      0.34369094   
       500   2580.277       1955.7507      178.98895      624.52625      185.08463      827.39299      175.04155      0             -984.94517      595290.88     -594868.93      3484.9211      55742.797      245.79118      0.67068326   
       550   2640.6832      1866.035       170.77823      774.64828      176.89583      988.92035      176.49762      0             -991.07215      595292.32     -594868.91      1773.3498      55742.797      234.10561      1.7344373    
       600   2690.8563      1876.0663      171.69629      814.78992      186.23945      1032.0131      182.30326      0             -1010.7649      595293.3      -594868.3       919.72218      55742.797      235.38014      1.7010069    
       650   2732.1824      1963.542       179.70201      768.64032      165.39208      949.23886      183.81872      0             -951.98443      595290.3      -594868.13      2658.9043      55742.797      246.76773      0.6803753    
       700   2775.7291      1921.9362      175.89427      853.79295      175.21238      987.66719      186.48679      0             -918.75395      595291.36     -594868.18      670.06352      55742.797      241.62282      0.44222483   
       750   2820.0749      2038.1503      186.53011      781.92456      168.58538      929.80572      193.62703      0             -939.93779      595298.09     -594868.25      398.72963      55742.797      256.20117      0.55406929   
       800   2865.9591      1943.5753      177.87467      922.38379      197.16024      1009.2236      201.50384      0             -914.81695      595297.54     -594868.23     -717.10741      55742.797      244.04519      1.2420612    
       850   2909.1136      2101.557       192.33304      807.55662      195.18903      876.12793      184.47425      0             -876.31499      595296.17     -594868.09     -1403.4252      55742.797      263.69791      1.8343785    
       900   2938.1375      2038.924       186.60091      899.21353      183.32678      989.0166       184.31264      0             -889.86013      595300.05     -594867.63     -1087.2735      55742.797      256.1273       1.0106163    
       950   2965.6939      2007.9419      183.76545      957.75206      227.45526      972.71519      206.3795       0             -880.42314      595299.46     -594867.83     -1848.759       55742.797      252.40651      0.53885862   
      1000   2994.2322      2058.0185      188.34843      936.21363      170.68933      965.88099      205.36604      0             -833.14439      595294.86     -594867.44      327.63972      55742.797      258.71293      0.52143389   
      1050   3022.9504      2095.3849      191.76817      927.56553      203.9075       935.91393      205.08196      0             -845.07238      595294.32     -594866.59     -355.70214      55742.797      263.25608      0.94199101   
      1100   3051.1762      2047.7197      187.40589      1003.4566      212.39893      989.65699      227.20826      0             -856.11278      595297.04     -594866.74     -1402.0215      55742.797      256.98381      1.6773479    
      1150   3071.8161      2127.8634      194.74059      943.95264      188.38431      926.24289      223.28028      0             -821.63204      595294.06     -594866.38      550.31108      55742.797      267.1916       1.3431389    
      1200   3087.7693      2015.2955      184.43845      1072.4739      199.90932      1034.9533      215.15489      0             -804.43296      595293.38     -594866.49     -333.57436      55742.797      253.26777      0.70914965   
      1250   3102.5823      2176.9518      199.23312      925.63051      155.8151       956.83606      230.07331      0             -847.47694      595296.65     -594866.26     -932.66404      55742.797      273.66551      0.54751823   
      1300   3116.8401      2087.605       191.05617      1029.2351      209.96219      974.81017      241.13585      0             -823.38384      595292.74     -594866.03     -825.75438      55742.797      262.34492      0.76175903   
      1350   3131.079       2089.6519      191.24349      1041.4271      186.48185      998.11161      233.71006      0             -801.36944      595290.06     -594865.57      684.79504      55742.797      262.36791      1.3871361    
      1400   3138.9957      2186.2574      200.08476      952.73835      168.60365      957.20133      227.72018      0             -826.5224       595291.08     -594865.34      1796.7384      55742.797      274.47393      1.5135626    
      1450   3139.579       2010.7384      184.02139      1128.8406      192.8016       1074.5205      245.37321      0             -807.31794      595288.01     -594864.55     -16.537538      55742.797      252.63144      0.87723777   
      1500   3143.8992      2099.4529      192.14048      1044.4463      186.04062      980.83466      242.01408      0             -784.81221      595285        -594864.63      2343.8762      55742.797      263.89145      0.61241068   
      1550   3149.7315      2086.0635      190.91509      1063.668       165.80569      1056.0897      230.8969       0             -813.37647      595289.09     -594864.84      2260.748       55742.797      262.17608      0.69485965   
      1600   3156.5368      2013.422       184.26698      1143.1149      210.65938      1098.2874      243.95635      0             -835.61837      595290.47     -594864.64     -838.57416      55742.797      252.86512      1.1543499    
      1650   3160.0058      2081.0773      190.45876      1078.9285      212.21951      1005.7478      250.37604      0             -813.72175      595289.15     -594864.85      796.1796       55742.797      261.22597      1.5557277    
      1700   3155.5607      2113.3809      193.41516      1042.1798      146.03466      1019.0917      249.77534      0             -798.16073      595290.58     -594865.14      359.65453      55742.797      265.47057      1.0739705    
      1750   3151.7978      2063.5464      188.85434      1088.2514      224.89105      997.01847      247.37606      0             -807.87748      595291.82     -594864.98     -1081.3025      55742.797      259.34332      0.69488047   
      1800   3150.43        2097.9212      192.00029      1052.5088      202.22708      974.42154      248.59742      0             -799.53989      595291.61     -594864.8       94.549871      55742.797      263.68371      0.65252444   
      1850   3153.4532      2106.6416      192.79838      1046.8117      177.5737       971.72292      249.9035       0             -777.13229      595289.76     -594865.02      881.44778      55742.797      264.65196      0.99604208   
      1900   3159.2064      2092.2694      191.48304      1066.937       198.79078      969.4187       260.02417      0             -787.25337      595290.41     -594864.45      606.48793      55742.797      262.66091      1.4839137    
      1950   3164.5215      2059.5742      188.49081      1104.9472      214.12608      1000.4416      263.39622      0             -799.45089      595291.13     -594864.69     -1248.8301      55742.797      258.63076      1.2624481    
      2000   3171.3001      2080.1581      190.37463      1091.142       179.22043      996.4117       248.42529      0             -760.0096       595292.03     -594864.94      940.6178       55742.797      261.39981      0.78377895   
Loop time of 10.3801 on 4 procs for 2000 steps with 4500 atoms

Performance: 8.324 ns/day, 2.883 hours/ns, 192.675 timesteps/s, 867.040 katom-step/s
91.4% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.3622     | 4.5822     | 4.6844     |   6.0 | 44.14
Bond    | 0.46181    | 0.4997     | 0.52066    |   3.4 |  4.81
Kspace  | 3.1903     | 3.2892     | 3.5003     |   6.8 | 31.69
Neigh   | 0.15864    | 0.23085    | 0.29748    |  13.8 |  2.22
Comm    | 0.27011    | 0.41514    | 0.52628    |  17.4 |  4.00
Output  | 0.0014482  | 0.0015968  | 0.0019859  |   0.6 |  0.02
Modify  | 1.3397     | 1.3419     | 1.3446     |   0.2 | 12.93
Other   |            | 0.01968    |            |       |  0.19

Nlocal:           1125 ave        1166 max        1096 min
Histogram: 2 0 0 0 0 0 1 0 0 1
Nghost:        5867.25 ave        5956 max        5793 min
Histogram: 1 1 0 0 0 0 1 0 0 1
Neighs:         193607 ave      200508 max      186199 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 774429
Ave neighs/atom = 172.09533
Ave special neighs/atom = 13.333333
Neighbor list builds = 35
Dangerous builds = 0
Total wall time: 0:00:10
