LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-584-g3e8807bee0-modified)
  using 1 OpenMP thread(s) per MPI task
# 250 toluene system for drude polarizability example (Nose-Hoover)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
improper_style fourier
special_bonds lj/coul 0.0 0.0 0.5

pair_style lj/cut/thole/long 2.600 8.0 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.toluene extra/special/per/atom 1
Reading data file ...
  orthogonal box = (-18.290765 -18.163588 -18.223046) to (18.335673 18.162094 18.328654)
  2 by 1 by 2 MPI processor grid
  reading atoms ...
  5500 atoms
  scanning bonds ...
  4 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  8 = max dihedrals/atom
  scanning impropers ...
  2 = max impropers/atom
  orthogonal box = (-18.290765 -18.163588 -18.223046) to (18.335673 18.162094 18.328654)
  2 by 1 by 2 MPI processor grid
  reading bonds ...
  5500 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6000 dihedrals
  reading impropers ...
  1500 impropers
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0.5     
  special bond factors coul:  0        0        0.5     
     5 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    16 = max # of 1-4 neighbors
    20 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.039 seconds

comm_modify vel yes

group gTOLUENE molecule 1:250
5500 atoms in group gTOLUENE
group gCORES type 1 2 3 4 5 6 7
3750 atoms in group gCORES
group gDRUDES type 8 9 10 11 12
1750 atoms in group gDRUDES

pair_coeff    1    1 0.069998 3.550000 1.620000 # CAT CAT
pair_coeff    1    2 0.069998 3.550000 1.620000 # CAT CAO
pair_coeff    1    3 0.069998 3.550000 1.620000 # CAT CAM
pair_coeff    1    4 0.069998 3.550000 1.620000 # CAT CAP
pair_coeff    1    5 0.067968 3.524911 1.620000 # CAT CTT
pair_coeff    1    6 0.045825 2.931041 0.000000 # CAT HAT
pair_coeff    1    7 0.045825 2.931041 0.000000 # CAT HT
pair_coeff    2    2 0.069998 3.550000 1.620000 # CAO CAO
pair_coeff    2    3 0.069998 3.550000 1.620000 # CAO CAM
pair_coeff    2    4 0.069998 3.550000 1.620000 # CAO CAP
pair_coeff    2    5 0.067968 3.524911 1.620000 # CAO CTT
pair_coeff    2    6 0.045825 2.931041 0.000000 # CAO HAT
pair_coeff    2    7 0.045825 2.931041 0.000000 # CAO HT
pair_coeff    3    3 0.069998 3.550000 1.620000 # CAM CAM
pair_coeff    3    4 0.069998 3.550000 1.620000 # CAM CAP
pair_coeff    3    5 0.067968 3.524911 1.620000 # CAM CTT
pair_coeff    3    6 0.045825 2.931041 0.000000 # CAM HAT
pair_coeff    3    7 0.045825 2.931041 0.000000 # CAM HT
pair_coeff    4    4 0.069998 3.550000 1.620000 # CAP CAP
pair_coeff    4    5 0.067968 3.524911 1.620000 # CAP CTT
pair_coeff    4    6 0.045825 2.931041 0.000000 # CAP HAT
pair_coeff    4    7 0.045825 2.931041 0.000000 # CAP HT
pair_coeff    5    5 0.065997 3.500000 1.620000 # CTT CTT
pair_coeff    5    6 0.044496 2.910326 0.000000 # CTT HAT
pair_coeff    5    7 0.044496 2.910326 0.000000 # CTT HT
pair_coeff    6    6 0.029999 2.420000 0.000000 # HAT HAT
pair_coeff    6    7 0.029999 2.420000 0.000000 # HAT HT
pair_coeff    7    7 0.029999 2.420000 0.000000 # HT HT
pair_coeff    1    8 0.000000 0.000000 1.620000 # CAT D_CAT
pair_coeff    1    9 0.000000 0.000000 1.620000 # CAT D_CAO
pair_coeff    1   10 0.000000 0.000000 1.620000 # CAT D_CAM
pair_coeff    1   11 0.000000 0.000000 1.620000 # CAT D_CAP
pair_coeff    1   12 0.000000 0.000000 1.620000 # CAT D_CTT
pair_coeff    2    8 0.000000 0.000000 1.620000 # CAO D_CAT
pair_coeff    2    9 0.000000 0.000000 1.620000 # CAO D_CAO
pair_coeff    2   10 0.000000 0.000000 1.620000 # CAO D_CAM
pair_coeff    2   11 0.000000 0.000000 1.620000 # CAO D_CAP
pair_coeff    2   12 0.000000 0.000000 1.620000 # CAO D_CTT
pair_coeff    3    8 0.000000 0.000000 1.620000 # CAM D_CAT
pair_coeff    3    9 0.000000 0.000000 1.620000 # CAM D_CAO
pair_coeff    3   10 0.000000 0.000000 1.620000 # CAM D_CAM
pair_coeff    3   11 0.000000 0.000000 1.620000 # CAM D_CAP
pair_coeff    3   12 0.000000 0.000000 1.620000 # CAM D_CTT
pair_coeff    4    8 0.000000 0.000000 1.620000 # CAP D_CAT
pair_coeff    4    9 0.000000 0.000000 1.620000 # CAP D_CAO
pair_coeff    4   10 0.000000 0.000000 1.620000 # CAP D_CAM
pair_coeff    4   11 0.000000 0.000000 1.620000 # CAP D_CAP
pair_coeff    4   12 0.000000 0.000000 1.620000 # CAP D_CTT
pair_coeff    5    8 0.000000 0.000000 1.620000 # CTT D_CAT
pair_coeff    5    9 0.000000 0.000000 1.620000 # CTT D_CAO
pair_coeff    5   10 0.000000 0.000000 1.620000 # CTT D_CAM
pair_coeff    5   11 0.000000 0.000000 1.620000 # CTT D_CAP
pair_coeff    5   12 0.000000 0.000000 1.620000 # CTT D_CTT
pair_coeff    8    8 0.000000 0.000000 1.620000 # D_CAT D_CAT
pair_coeff    8    9 0.000000 0.000000 1.620000 # D_CAT D_CAO
pair_coeff    8   10 0.000000 0.000000 1.620000 # D_CAT D_CAM
pair_coeff    8   11 0.000000 0.000000 1.620000 # D_CAT D_CAP
pair_coeff    8   12 0.000000 0.000000 1.620000 # D_CAT D_CTT
pair_coeff    9    9 0.000000 0.000000 1.620000 # D_CAO D_CAO
pair_coeff    9   10 0.000000 0.000000 1.620000 # D_CAO D_CAM
pair_coeff    9   11 0.000000 0.000000 1.620000 # D_CAO D_CAP
pair_coeff    9   12 0.000000 0.000000 1.620000 # D_CAO D_CTT
pair_coeff   10   10 0.000000 0.000000 1.620000 # D_CAM D_CAM
pair_coeff   10   11 0.000000 0.000000 1.620000 # D_CAM D_CAP
pair_coeff   10   12 0.000000 0.000000 1.620000 # D_CAM D_CTT
pair_coeff   11   11 0.000000 0.000000 1.620000 # D_CAP D_CAP
pair_coeff   11   12 0.000000 0.000000 1.620000 # D_CAP D_CTT
pair_coeff   12   12 0.000000 0.000000 1.620000 # D_CTT D_CTT


neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C C C C N N D D D D D

fix fSHAKE gCORES shake 0.0001 20 0 b 4 6 7 8
Finding SHAKE clusters ...
    1250 = # of size 2 clusters
       0 = # of size 3 clusters
     250 = # of size 4 clusters
       0 = # of frozen angles
  find clusters CPU = 0.000 seconds

compute cTEMP_CORE gCORES temp/com
compute cTEMP all temp/drude

fix fDIRECT all drude/transform/direct
fix fNVT1 gCORES nvt temp ${vTEMP} ${vTEMP} 100.0
fix fNVT1 gCORES nvt temp 260 ${vTEMP} 100.0
fix fNVT1 gCORES nvt temp 260 260 100.0
fix fNVT2 gDRUDES nvt temp ${vTEMP_D} ${vTEMP_D} 20.0
fix fNVT2 gDRUDES nvt temp 1 ${vTEMP_D} 20.0
fix fNVT2 gDRUDES nvt temp 1 1 20.0
fix fINVERSE all drude/transform/inverse

fix fMOMENTUM all momentum 100 linear 1 1 1

thermo_style custom step etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.38201098
  grid = 40 40 40
  stencil order = 5
  estimated absolute RMS force accuracy = 0.032593379
  estimated relative force accuracy = 9.8153994e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 34263 16000
Generated 10 of 66 mixed pair_coeff terms from geometric mixing rule
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 19
New max number of 1-2 to 1-4 neighbors: 20 (+1)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/thole/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 18.34 | 18.34 | 18.34 Mbytes
   Step         TotEng         KinEng          Temp          PotEng         E_bond        E_angle        E_dihed        E_impro         E_vdwl         E_coul         E_long         Press          Volume       c_cTEMP[1]     c_cTEMP[2]  
         0   11086.38       2910.7282      202.07402      8175.6516      6565.4851      20.333365      1.0706727e-06 -3299.85        4972.8631      1306116.7     -1306199.8      40273.655      48631.318      314.89553      3.1777821    
        50   3563.3763      4630.6335      321.47649     -1067.2572      735.72624      604.7866       689.14825     -3277.411       815.58185      1306088.7     -1306723.8      17813.41       48631.318      503.82692      0.0087121502 
       100   3327.4747      4395.1102      305.12556     -1067.6355      597.93699      651.62626      945.41507     -3267.2851      584.5884       1306135.9     -1306715.8      17407.332      48631.318      478.20165      0.0075989601 
       150   3036.91        4740.2291      329.08504     -1703.3191      558.65575      619.91293      658.8068      -3278.7837      285.12479      1306173       -1306720        18448.252      48631.318      515.75272      0.0063219173 
       200   2697.9605      4559.3437      316.52728     -1861.3832      522.09846      593.89117      754.61436     -3273.49        87.660603      1306183.9     -1306730        17888.929      48631.318      496.07134      0.0068710259 
       250   2348.7583      4410.5839      306.1998      -2061.8257      506.05491      575.35161      715.55052     -3276.3261     -18.364533      1306177.3     -1306741.4      11592.029      48631.318      479.8855       0.0071745643 
       300   2019.8271      4040.1403      280.48217     -2020.3132      604.31242      641.66668      693.93789     -3278.5312     -115.73612      1306183.2     -1306749.1      3631.371       48631.318      439.57983      0.0069892873 
       350   1699.5129      3944.9847      273.8761      -2245.4718      452.07861      638.06481      658.791       -3279.6053     -157.07616      1306196.9     -1306754.6      13544.381      48631.318      429.2269       0.0062876894 
       400   1399.2965      3726.0964      258.68003     -2326.7998      457.92465      621.44729      639.39889     -3279.2395     -188.85918      1306185.4     -1306762.8      10792.25       48631.318      405.41115      0.0059345687 
       450   1120.5243      3518.3436      244.25703     -2397.8193      519.49329      584.65761      646.36682     -3278.6685     -289.59888      1306184.1     -1306764.2      2755.549       48631.318      382.80701      0.0055711244 
       500   868.02095      3359.8789      233.25579     -2491.8579      460.74391      581.495        581.0173      -3281.5544     -252.20171      1306184.3     -1306765.7      6120.3714      48631.318      365.56523      0.0058762472 
       550   637.01471      3214.9508      223.19433     -2577.9361      431.81988      578.87402      540.94039     -3281.5337     -266.36058      1306182.8     -1306764.5      8622.4403      48631.318      349.79647      0.0058598223 
       600   418.04276      3113.4055      216.14465     -2695.3627      430.46411      538.68143      522.24585     -3283.456      -311.88141      1306174.3     -1306765.8      7068.9222      48631.318      338.74787      0.005957363  
       650   218.59326      2930.8426      203.47043     -2712.2494      514.4777       514.2833       551.52558     -3282.0904     -405.37359      1306164.5     -1306769.5     -13.587437      48631.318      318.88467      0.0052673223 
       700   45.22745       2830.1427      196.47946     -2784.9153      451.11587      498.26412      541.18812     -3282.1428     -375.95201      1306157.1     -1306774.4      3947.666       48631.318      307.92724      0.0068028382 
       750  -114.28065      2798.3149      194.26985     -2912.5955      412.75787      503.2876       481.32119     -3284.3411     -393.53935      1306147       -1306779.1      7143.3418      48631.318      304.46461      0.0061605136 
       800  -263.64031      2694.8107      187.08419     -2958.451       455.68391      487.4965       476.86524     -3284.3133     -451.95757      1306144.9     -1306787.2      1185.8611      48631.318      293.20313      0.0058210796 
       850  -397.71728      2559.1907      177.66892     -2956.9079      458.83773      481.226        478.31204     -3284.068      -437.26368      1306138.6     -1306792.6      346.82784      48631.318      278.44729      0.005492763  
       900  -515.18188      2544.8728      176.67492     -3060.0547      395.00607      457.58888      446.68551     -3285.4849     -423.56161      1306145       -1306795.3      3712.8724      48631.318      276.88836      0.0074069912 
       950  -617.28794      2451.1719      170.16984     -3068.4599      383.64784      446.59657      434.4628      -3285.1347     -391.59095      1306142.3     -1306798.7      5429.1641      48631.318      266.69427      0.0057498715 
      1000  -703.15085      2334.8368      162.0934      -3037.9876      424.35489      462.20932      451.80778     -3284.3803     -426.53362      1306133.9     -1306799.3      1137.5832      48631.318      254.03673      0.0053920948 
      1050  -771.18112      2303.8354      159.94117     -3075.0165      426.21846      436.50646      435.10124     -3285.1938     -411.13914      1306125.6     -1306802.1      1636.91        48631.318      250.66278      0.0069365091 
      1100  -822.71801      2283.4214      158.52395     -3106.1394      376.68156      447.77473      418.45928     -3286.5918     -377.48537      1306118.9     -1306803.8      4760.5405      48631.318      248.44138      0.0074027388 
      1150  -857.05475      2259.0876      156.8346      -3116.1423      400.32035      431.65725      457.68017     -3285.1977     -430.493        1306115.8     -1306805.9      3194.3081      48631.318      245.79396      0.0070648979 
      1200  -875.50918      2238.265       155.38901     -3113.7741      445.38653      460.9676       432.10438     -3285.4239     -472.45872      1306114.7     -1306809       -653.37396      48631.318      243.52833      0.0071468314 
      1250  -880.37286      2294.686       159.30598     -3175.0589      411.36092      444.73286      420.06203     -3286.0365     -458.04729      1306104.4     -1306811.5      945.90122      48631.318      249.66449      0.011859928  
      1300  -871.30362      2284.2302      158.5801      -3155.5338      404.9874       441.75214      426.34878     -3285.4859     -424.80021      1306094.9     -1306813.2      4406.4895      48631.318      248.48564      0.084490227  
      1350  -816.67478      2325.9555      161.47683     -3142.6303      697.11246      442.49791      431.19482     -3285.786      -450.28305      1305835.9     -1306813.3      593.42878      48631.318      251.40971      2.9313912    
      1400  -794.27503      2263.512       157.14176     -3057.787       645.45313      466.21628      446.2219      -3285.1824     -420.66389      1305903.9     -1306813.8      1386.1346      48631.318      245.20631      1.8906174    
      1450  -776.10858      2287.6327      158.81631     -3063.7412      427.03058      479.09708      439.69361     -3285.9534     -395.11841      1306087.6     -1306816.1      2937.0584      48631.318      248.86901      0.061281222  
      1500  -725.47502      2371.4063      164.6322      -3096.8814      390.03991      464.29681      446.92646     -3284.7807     -393.1612       1306095.4     -1306815.6      3544.5751      48631.318      258.01213      0.011593082  
      1550  -671.47868      2315.9179      160.77998     -2987.3965      457.039        500.29234      464.76737     -3284.9303     -401.0096       1306091.7     -1306815.3      2051.9799      48631.318      251.97596      0.0094610323 
      1600  -618.83702      2449.0769      170.0244      -3067.9139      425.46788      474.68269      471.99835     -3284.3676     -430.33001      1306091.3     -1306816.6      441.46941      48631.318      266.46149      0.01427186   
      1650  -567.80623      2425.2167      168.36793     -2993.023       421.03692      511.21091      463.22565     -3285.037      -377.21361      1306088.4     -1306814.7      5198.0539      48631.318      263.83105      0.074786125  
      1700  -502.39342      2441.7829      169.51802     -2944.1763      642.6749       512.8508       490.516       -3283.9748     -417.40209      1305928.9     -1306817.7      1140.6479      48631.318      264.5141       2.0470966    
      1750  -459.52918      2499.1587      173.50126     -2958.6878      678.86888      505.17679      484.78991     -3284.6276     -384.27121      1305862.2     -1306820.8      1527.9768      48631.318      270.112        3.1832104    
      1800  -471.12045      2476.221       171.90885     -2947.3415      442.51915      530.46628      474.06724     -3284.0981     -371.97669      1306084.3     -1306822.6      3392.928       48631.318      269.36394      0.10402048   
      1850  -462.75777      2536.8196      176.11583     -2999.5773      437.10759      524.98402      474.10147     -3283.7923     -422.24453      1306091.6     -1306821.3      1629.0113      48631.318      276.00679      0.016833192  
      1900  -469.83709      2469.0372      171.41012     -2938.8743      446.87033      531.5974       496.12316     -3284.2279     -395.34781      1306085.7     -1306819.6      3115.0469      48631.318      268.63305      0.014630006  
      1950  -491.01598      2445.8066      169.79736     -2936.8226      457.79137      527.28511      470.13459     -3283.9707     -391.94062      1306101.8     -1306817.9      1123.2717      48631.318      266.10301      0.018936433  
      2000  -518.31615      2418.056       167.8708      -2936.3721      415.97153      536.85831      480.58785     -3283.7825     -363.59499      1306096.3     -1306818.7      4471.4326      48631.318      263.01781      0.13491133   
Loop time of 16.3858 on 4 procs for 2000 steps with 5500 atoms

Performance: 5.273 ns/day, 4.552 hours/ns, 122.057 timesteps/s, 671.313 katom-step/s
90.7% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.613      | 7.0254     | 7.2721     |   9.7 | 42.88
Bond    | 0.48952    | 0.49977    | 0.50369    |   0.8 |  3.05
Kspace  | 4.9121     | 5.5392     | 6.4855     |  27.9 | 33.80
Neigh   | 0.2734     | 0.39227    | 0.49816    |  16.9 |  2.39
Comm    | 0.42611    | 1.0623     | 1.7704     |  61.6 |  6.48
Output  | 0.00173    | 0.001889   | 0.0022717  |   0.5 |  0.01
Modify  | 1.8222     | 1.8283     | 1.8319     |   0.3 | 11.16
Other   |            | 0.03661    |            |       |  0.22

Nlocal:           1375 ave        1407 max        1349 min
Histogram: 1 0 0 1 1 0 0 0 0 1
Nghost:         8082.5 ave        8114 max        8047 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:         325721 ave      343523 max      314960 min
Histogram: 1 1 0 1 0 0 0 0 0 1

Total # of neighbors = 1302883
Ave neighs/atom = 236.88782
Ave special neighs/atom = 15.636364
Neighbor list builds = 44
Dangerous builds = 0
Total wall time: 0:00:16
