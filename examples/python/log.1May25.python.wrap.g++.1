LAMMPS (2 Apr 2025 - Development - patch_2Apr2025-125-g7ca493917a-modified)
# 3d Lennard-Jones melt with equal- and atom-style variables which
#   use a Python function wrapper in their formulas

variable        x index 5
variable        y index 5
variable        z index 5

units           lj
atom_style      atomic

lattice         fcc 0.8442
Lattice spacing in x,y,z = 1.6795962 1.6795962 1.6795962
region          box block 0 $x 0 $y 0 $z
region          box block 0 5 0 $y 0 $z
region          box block 0 5 0 5 0 $z
region          box block 0 5 0 5 0 5
create_box      1 box
Created orthogonal box = (0 0 0) to (8.397981 8.397981 8.397981)
  1 by 1 by 1 MPI processor grid
create_atoms    1 box
Created 500 atoms
  using lattice units in orthogonal box = (0 0 0) to (8.397981 8.397981 8.397981)
  create_atoms CPU = 0.000 seconds
mass            1 1.0

velocity        all create 1.44 87287 loop geom

pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    delay 0 every 20 check no

fix             1 all nve

variable        foo python truncate
python          truncate return v_foo input 1 v_pyarg1 format fi here """
def truncate(x):
  return int(x)
"""
variable        pyarg1 internal 0.0

variable        scalar equal py_foo(4.5)
print           "TRUNCATE ${scalar}"
TRUNCATE 4

variable        xtrunc atom py_foo(x)
variable        ytrunc atom py_foo(y)
variable        ztrunc atom py_foo(z)

#dump            1 all custom 100 tmp.dump id x y z
dump            1 all custom 100 tmp.dump id x y z v_xtrunc v_ytrunc v_ztrunc

run             100
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 20 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.8
  ghost atom cutoff = 2.8
  binsize = 1.4, bins = 6 6 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 2.644 | 2.644 | 2.644 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   1.44          -6.7733681      0             -4.6176881     -5.0221006    
       100   0.75627408    -5.7580082      0             -4.6258659      0.21870071   
Loop time of 0.0160255 on 1 procs for 100 steps with 500 atoms

Performance: 2695709.610 tau/day, 6240.069 timesteps/s, 3.120 Matom-step/s
100.0% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.011326   | 0.011326   | 0.011326   |   0.0 | 70.67
Neigh   | 0.002924   | 0.002924   | 0.002924   |   0.0 | 18.25
Comm    | 0.00046255 | 0.00046255 | 0.00046255 |   0.0 |  2.89
Output  | 0.0010398  | 0.0010398  | 0.0010398  |   0.0 |  6.49
Modify  | 0.00020589 | 0.00020589 | 0.00020589 |   0.0 |  1.28
Other   |            | 6.725e-05  |            |       |  0.42

Nlocal:            500 ave         500 max         500 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           1941 ave        1941 max        1941 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          18766 ave       18766 max       18766 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 18766
Ave neighs/atom = 37.532
Neighbor list builds = 5
Dangerous builds not checked
Total wall time: 0:00:00
