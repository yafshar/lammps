LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-739-g2644e7f6fa-modified)
  using 1 OpenMP thread(s) per MPI task
# Testsystem for core-shell model compared to Mitchell and Fincham
# Hendrik Heenen, June 2014

# ------------------------ INITIALIZATION ----------------------------

units 		metal
dimension	3
boundary	p	p	p
atom_style	full

# ----------------------- ATOM DEFINITION ----------------------------

fix csinfo all property/atom i_CSID
read_data data.coreshell fix csinfo NULL CS-Info
Reading data file ...
  orthogonal box = (0 0 0) to (24.09597 24.09597 24.09597)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  432 atoms
  scanning bonds ...
  1 = max bonds/atom
  orthogonal box = (0 0 0) to (24.09597 24.09597 24.09597)
  1 by 1 by 1 MPI processor grid
  reading bonds ...
  216 bonds
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     1 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.004 seconds

group cores type 1 2
216 atoms in group cores
group shells type 3 4
216 atoms in group shells

neighbor 2.0 bin
comm_modify vel yes

# ------------------------ FORCE FIELDS ------------------------------

kspace_style ewald 1.0e-6
pair_style   born/coul/long/cs 20.0 20.0    # A, rho, sigma=0, C, D
pair_coeff   * *      0.0 1.000   0.00  0.00   0.00
pair_coeff   3 3    487.0 0.23768 0.00  1.05   0.50 #Na-Na
pair_coeff   3 4 145134.0 0.23768 0.00  6.99   8.70 #Na-Cl
pair_coeff   4 4 405774.0 0.23768 0.00 72.40 145.40 #Cl-Cl

bond_style harmonic
bond_coeff 1 63.014 0.0
bond_coeff 2 25.724 0.0

# ------------------------ Equilibration Run -------------------------------

reset_timestep 0

thermo 50
thermo_style custom step etotal pe ke temp press              epair evdwl ecoul elong ebond fnorm fmax vol

compute CStemp all temp/cs cores shells
compute thermo_press_lmp all pressure thermo_temp # press for correct kinetic scalar

# output via chunk method

#compute prop all property/atom i_CSID
#compute cs_chunk all chunk/atom c_prop
#compute cstherm all temp/chunk cs_chunk temp internal com yes cdof 3.0
#fix ave_chunk all ave/time 100 1 100 c_cstherm file chunk.dump mode vector

thermo_modify temp CStemp press thermo_press_lmp

# 2 fmsec timestep

timestep 0.002

# velocity bias option

velocity all create 1427 134 dist gaussian mom yes rot no bias yes temp CStemp
Ewald initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.17525654
  estimated absolute RMS force accuracy = 1.4956298e-05
  estimated relative force accuracy = 1.0386574e-06
  KSpace vectors: actual max1d max3d = 257 5 665
                  kxmax kymax kzmax  = 5 5 5
Generated 0 of 6 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 22
  ghost atom cutoff = 22
  binsize = 11, bins = 3 3 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair born/coul/long/cs, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
velocity all scale 1427 temp CStemp

# thermostating using the core/shell decoupling

fix thermoberendsen all temp/berendsen 1427 1427 0.4
fix nve all nve
fix_modify thermoberendsen temp CStemp

run 500
Ewald initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.17525654
  estimated absolute RMS force accuracy = 1.4956298e-05
  estimated relative force accuracy = 1.0386574e-06
  KSpace vectors: actual max1d max3d = 257 5 665
                  kxmax kymax kzmax  = 5 5 5
Generated 0 of 6 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 17.54 | 17.54 | 17.54 Mbytes
   Step         TotEng         PotEng         KinEng          Temp          Press          E_pair         E_vdwl         E_coul         E_long         E_bond         Fnorm           Fmax          Volume    
         0  -635.44091     -675.09857      39.657659      1427          -20613.604     -675.09857      1.6320365      1018.8212     -1695.5518      0              2.8962997e-14  3.5962308e-15  13990.5      
        50  -634.17327     -666.17818      32.004909      1151.6314     -4029.8422     -667.9562       37.809071      989.23283     -1694.9981      1.7780232      9.7133803      2.1917981      13990.5      
       100  -631.93508     -661.91226      29.977186      1078.6679     -3171.7793     -664.06719      39.33341       991.36934     -1694.7699      2.1549306      11.091424      2.1704425      13990.5      
       150  -630.16811     -663.12417      32.956058      1185.8566      143.26309     -665.48036      46.253762      982.97455     -1694.7087      2.3561923      11.46791       2.1652593      13990.5      
       200  -628.62324     -663.64924      35.026002      1260.3393     -1622.4104     -665.9688       41.661884      986.81673     -1694.4474      2.3195585      10.597706      2.9538249      13990.5      
       250  -627.31044     -662.01824      34.707801      1248.8895     -1509.6669     -664.50312      42.101705      987.90199     -1694.5068      2.484874       10.392754      1.6933708      13990.5      
       300  -626.57624     -660.97496      34.398715      1237.7676     -1637.8155     -663.48089      41.653224      989.53227     -1694.6664      2.5059307      11.204363      2.2810012      13990.5      
       350  -625.91962     -665.3584       39.438778      1419.124      -1351.5048     -667.61672      41.582391      985.53387     -1694.733       2.2583198      10.831008      1.8963524      13990.5      
       400  -625.24851     -660.77656      35.528055      1278.4046     -424.51882     -663.12615      43.890156      987.75204     -1694.7684      2.3495902      11.521902      2.1759184      13990.5      
       450  -624.67743     -662.88674      38.209312      1374.8842      1109.0639     -665.43206      46.964901      982.35205     -1694.749       2.545319       11.002302      2.001422       13990.5      
       500  -624.30214     -661.97847      37.676334      1355.7061     -998.38232     -664.60372      42.373513      987.58993     -1694.5672      2.6252488      11.15392       2.827216       13990.5      
Loop time of 1.90061 on 1 procs for 500 steps with 432 atoms

Performance: 45.459 ns/day, 0.528 hours/ns, 263.073 timesteps/s, 113.648 katom-step/s
99.6% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.6567     | 1.6567     | 1.6567     |   0.0 | 87.17
Bond    | 0.00050534 | 0.00050534 | 0.00050534 |   0.0 |  0.03
Kspace  | 0.15258    | 0.15258    | 0.15258    |   0.0 |  8.03
Neigh   | 0.064461   | 0.064461   | 0.064461   |   0.0 |  3.39
Comm    | 0.020344   | 0.020344   | 0.020344   |   0.0 |  1.07
Output  | 0.00018488 | 0.00018488 | 0.00018488 |   0.0 |  0.01
Modify  | 0.0043808  | 0.0043808  | 0.0043808  |   0.0 |  0.23
Other   |            | 0.001461   |            |       |  0.08

Nlocal:            432 ave         432 max         432 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           9338 ave        9338 max        9338 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         297353 ave      297353 max      297353 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 297353
Ave neighs/atom = 688.31713
Ave special neighs/atom = 1
Neighbor list builds = 22
Dangerous builds = 0

unfix thermoberendsen
unfix nve

fix npt_equ all npt temp 1427 1427 0.04 iso 0 0 0.4
fix_modify npt_equ temp CStemp press thermo_press_lmp # pressure for correct kinetic scalar

run 500
Ewald initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.17525654
  estimated absolute RMS force accuracy = 1.4956298e-05
  estimated relative force accuracy = 1.0386574e-06
  KSpace vectors: actual max1d max3d = 257 5 665
                  kxmax kymax kzmax  = 5 5 5
Generated 0 of 6 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 17.54 | 17.54 | 17.54 Mbytes
   Step         TotEng         PotEng         KinEng          Temp          Press          E_pair         E_vdwl         E_coul         E_long         E_bond         Fnorm           Fmax          Volume    
       500  -624.30214     -661.97847      37.676334      1355.7061     -998.38232     -664.60372      42.373513      987.58993     -1694.5672      2.6252488      11.15392       2.827216       13990.5      
       550  -615.79466     -659.52805      43.733389      1573.6568      1465.3804     -662.38703      46.786716      985.56531     -1694.7391      2.8589855      11.815147      2.0439902      13960.8      
       600  -620.24376     -658.17917      37.935407      1365.0283     -1861.4892     -660.74673      40.165171      993.66069     -1694.5726      2.5675637      10.381676      1.7148476      14314.942    
       650  -614.82897     -655.33177      40.502801      1457.4107      1459.6229     -658.2337       47.465019      988.91519     -1694.6139      2.9019296      12.827094      2.1531452      14250.339    
       700  -619.719       -659.70718      39.988188      1438.8934      536.70372     -662.27334      45.424273      986.72343     -1694.421       2.5661611      10.847068      1.9150368      14377.917    
       750  -616.60545     -654.59626      37.990804      1367.0216      8.1481742     -657.6676       44.34885       992.76026     -1694.7767      3.0713426      11.807225      3.3452789      14719.929    
       800  -615.36784     -653.67407      38.306228      1378.3715     -417.40178     -656.12718      43.184544      995.27947     -1694.5912      2.4531076      11.265482      1.7840144      15122.745    
       850  -616.06843     -657.1064       41.037973      1476.6678     -776.84306     -659.53951      42.235993      993.01984     -1694.7953      2.433102       11.121522      1.9401049      15258.951    
       900  -615.53981     -658.29053      42.750726      1538.2977      78.537478     -660.91966      43.871686      989.72774     -1694.5191      2.6291252      10.691548      1.6609026      14824.635    
       950  -617.20324     -654.85267      37.64943       1354.738       1591.1243     -657.66107      47.549398      989.26949     -1694.48        2.8084036      11.839458      1.9255808      14348.523    
      1000  -612.41721     -655.24959      42.83238       1541.2359     -110.06408     -658.21419      43.040306      993.2511      -1694.5056      2.9645984      11.329453      2.6079191      14507.077    
Loop time of 1.83916 on 1 procs for 500 steps with 432 atoms

Performance: 46.978 ns/day, 0.511 hours/ns, 271.864 timesteps/s, 117.445 katom-step/s
99.6% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.5812     | 1.5812     | 1.5812     |   0.0 | 85.97
Bond    | 0.00073209 | 0.00073209 | 0.00073209 |   0.0 |  0.04
Kspace  | 0.15302    | 0.15302    | 0.15302    |   0.0 |  8.32
Neigh   | 0.069208   | 0.069208   | 0.069208   |   0.0 |  3.76
Comm    | 0.019377   | 0.019377   | 0.019377   |   0.0 |  1.05
Output  | 0.00012909 | 0.00012909 | 0.00012909 |   0.0 |  0.01
Modify  | 0.01408    | 0.01408    | 0.01408    |   0.0 |  0.77
Other   |            | 0.001417   |            |       |  0.08

Nlocal:            432 ave         432 max         432 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           9085 ave        9085 max        9085 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         288305 ave      288305 max      288305 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 288305
Ave neighs/atom = 667.37269
Ave special neighs/atom = 1
Neighbor list builds = 24
Dangerous builds = 0

unfix npt_equ

# ------------------------ Dynamic Run -------------------------------

fix npt_dyn all npt temp 1427 1427 0.04 iso 0 0 0.4
fix_modify npt_dyn temp CStemp press thermo_press_lmp # pressure for correct kinetic scalar
run 1000
Ewald initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.17512718
  estimated absolute RMS force accuracy = 1.5185076e-05
  estimated relative force accuracy = 1.0545452e-06
  KSpace vectors: actual max1d max3d = 257 5 665
                  kxmax kymax kzmax  = 5 5 5
Generated 0 of 6 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 17.54 | 17.54 | 17.54 Mbytes
   Step         TotEng         PotEng         KinEng          Temp          Press          E_pair         E_vdwl         E_coul         E_long         E_bond         Fnorm           Fmax          Volume    
      1000  -612.41721     -655.24959      42.83238       1541.2359     -118.78183     -658.21419      43.040306      992.00287     -1693.2574      2.9645984      11.329452      2.607919       14507.077    
      1050  -618.58993     -654.61346      36.023528      1296.2332     -1160.3808     -657.4616       41.804099      994.11825     -1693.3839      2.848138       11.362987      2.1934295      14324.196    
      1100  -615.88868     -654.25577      38.367096      1380.5617      3757.1281     -657.43745      52.359678      983.48259     -1693.2797      3.1816774      13.620468      2.0349733      14010.173    
      1150  -617.77711     -657.24414      39.467029      1420.1406     -417.14306     -659.98364      43.122092      989.97087     -1693.0766      2.7394983      10.72404       1.6504823      14413.051    
      1200  -616.6071      -657.69035      41.083246      1478.2969     -851.67169     -660.10227      41.931807      991.43528     -1693.4694      2.411922       10.836954      1.6627463      14698.384    
      1250  -616.29868     -656.93224      40.633569      1462.1161     -83.097937     -659.65951      43.825571      989.5665      -1693.0516      2.7272646      11.26054       2.0196128      14692.166    
      1300  -618.12545     -657.54668      39.421232      1418.4927      674.67402     -660.28935      45.796763      987.13824     -1693.2244      2.7426679      11.411032      1.7034112      14737.353    
      1350  -614.45045     -654.02448      39.574028      1423.9907      134.58544     -656.91325      44.269114      992.1467      -1693.3291      2.8887698      11.205712      1.9257054      15052.809    
      1400  -614.27994     -653.64581      39.365872      1416.5006     -28.492786     -656.53014      44.170779      992.50528     -1693.2062      2.8843322      11.388974      2.0373481      15474.922    
      1450  -612.22974     -653.95499      41.725252      1501.3981     -1312.8274     -656.55008      40.407162      996.07567     -1693.0329      2.5950857      9.8293928      1.6870006      15872.504    
      1500  -613.06804     -653.37434      40.3063        1450.34       -404.83273     -656.02047      43.04464       994.34303     -1693.4081      2.6461229      10.780867      1.8808727      15997.164    
      1550  -608.64681     -650.19837      41.551564      1495.1483      271.85247     -653.3849       44.542078      995.31342     -1693.2404      3.1865327      12.087133      2.4132776      16005.605    
      1600  -614.90986     -654.22165      39.31179       1414.5546     -1938.28       -656.83118      39.325745      997.08096     -1693.2379      2.6095273      10.43918       1.9960644      16090.786    
      1650  -613.69807     -653.3551       39.657028      1426.9773      1219.4796     -656.12401      47.152329      989.76413     -1693.0405      2.7689152      11.546084      2.4894056      15836.482    
      1700  -612.59636     -653.84665      41.250293      1484.3077     -1272.1        -656.53324      40.633075      996.04747     -1693.2138      2.6865826      10.887844      2.1281777      15961.976    
      1750  -615.5785      -654.15205      38.573551      1387.9906      36.193323     -656.78664      44.452471      991.99597     -1693.2351      2.6345882      11.727324      1.8342027      15868.473    
      1800  -613.02026     -652.37339      39.353129      1416.0421     -1209.8259     -655.2985       40.918106      996.90526     -1693.1219      2.9251108      10.636802      1.9466156      15756.394    
      1850  -610.89442     -653.88343      42.989002      1546.8716     -271.47546     -656.72441      42.733489      993.82769     -1693.2856      2.8409826      11.779977      1.7884675      15249.5      
      1900  -617.18633     -659.56713      42.380795      1524.9865      487.8387      -662.25476      44.887655      986.12839     -1693.2708      2.6876378      10.542239      1.8084749      14861.701    
      1950  -617.91647     -659.8031       41.886631      1507.205      -1483.5731     -662.43895      40.328649      990.56563     -1693.3332      2.6358494      9.7203314      1.9433796      14870.882    
      2000  -614.70155     -654.63842      39.936863      1437.0466      1339.0189     -657.6811       47.126634      988.26068     -1693.0684      3.0426843      12.371462      2.2186975      14696.169    
Loop time of 3.57087 on 1 procs for 1000 steps with 432 atoms

Performance: 48.392 ns/day, 0.496 hours/ns, 280.044 timesteps/s, 120.979 katom-step/s
99.6% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.044      | 3.044      | 3.044      |   0.0 | 85.24
Bond    | 0.0014985  | 0.0014985  | 0.0014985  |   0.0 |  0.04
Kspace  | 0.30424    | 0.30424    | 0.30424    |   0.0 |  8.52
Neigh   | 0.14967    | 0.14967    | 0.14967    |   0.0 |  4.19
Comm    | 0.039468   | 0.039468   | 0.039468   |   0.0 |  1.11
Output  | 0.00032531 | 0.00032531 | 0.00032531 |   0.0 |  0.01
Modify  | 0.028751   | 0.028751   | 0.028751   |   0.0 |  0.81
Other   |            | 0.002961   |            |       |  0.08

Nlocal:            432 ave         432 max         432 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           8990 ave        8990 max        8990 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         282879 ave      282879 max      282879 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 282879
Ave neighs/atom = 654.8125
Ave special neighs/atom = 1
Neighbor list builds = 51
Dangerous builds = 0
Total wall time: 0:00:07
