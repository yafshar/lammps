LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-356-gfb9a39f1cf-modified)
  using 1 OpenMP thread(s) per MPI task
# Testsystem for core-shell model compared to Mitchell and Fincham
# Hendrik Heenen, June 2014

# ------------------------ INITIALIZATION ----------------------------

units 		metal
dimension	3
boundary	p	p	p
atom_style	full

# ----------------------- ATOM DEFINITION ----------------------------

fix csinfo all property/atom i_CSID
read_data data.coreshell fix csinfo NULL CS-Info
Reading data file ...
  orthogonal box = (0 0 0) to (24.09597 24.09597 24.09597)
  1 by 2 by 2 MPI processor grid
  reading atoms ...
  432 atoms
  scanning bonds ...
  1 = max bonds/atom
  orthogonal box = (0 0 0) to (24.09597 24.09597 24.09597)
  1 by 2 by 2 MPI processor grid
  reading bonds ...
  216 bonds
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     1 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.006 seconds

group cores type 1 2
216 atoms in group cores
group shells type 3 4
216 atoms in group shells

neighbor 2.0 bin
comm_modify vel yes

# ------------------------ FORCE FIELDS ------------------------------

kspace_style ewald 1.0e-6
pair_style   born/coul/long/cs 20.0 20.0    # A, rho, sigma=0, C, D
pair_coeff   * *      0.0 1.000   0.00  0.00   0.00
pair_coeff   3 3    487.0 0.23768 0.00  1.05   0.50 #Na-Na
pair_coeff   3 4 145134.0 0.23768 0.00  6.99   8.70 #Na-Cl
pair_coeff   4 4 405774.0 0.23768 0.00 72.40 145.40 #Cl-Cl

bond_style harmonic
bond_coeff 1 63.014 0.0
bond_coeff 2 25.724 0.0

# ------------------------ Equilibration Run -------------------------------

reset_timestep 0

thermo 50
thermo_style custom step etotal pe ke temp press              epair evdwl ecoul elong ebond fnorm fmax vol

compute CStemp all temp/cs cores shells
compute thermo_press_lmp all pressure thermo_temp # press for correct kinetic scalar

# output via chunk method

#compute prop all property/atom i_CSID
#compute cs_chunk all chunk/atom c_prop
#compute cstherm all temp/chunk cs_chunk temp internal com yes cdof 3.0
#fix ave_chunk all ave/time 100 1 100 c_cstherm file chunk.dump mode vector

thermo_modify temp CStemp press thermo_press_lmp

# 2 fmsec timestep

timestep 0.002

# velocity bias option

velocity all create 1427 134 dist gaussian mom yes rot no bias yes temp CStemp
Ewald initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.17525654
  estimated absolute RMS force accuracy = 1.4956298e-05
  estimated relative force accuracy = 1.0386574e-06
  KSpace vectors: actual max1d max3d = 257 5 665
                  kxmax kymax kzmax  = 5 5 5
Generated 0 of 6 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 22
  ghost atom cutoff = 22
  binsize = 11, bins = 3 3 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair born/coul/long/cs, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
velocity all scale 1427 temp CStemp

# thermostating using the core/shell decoupling

fix thermoberendsen all temp/berendsen 1427 1427 0.4
fix nve all nve
fix_modify thermoberendsen temp CStemp

run 500
Ewald initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.17525654
  estimated absolute RMS force accuracy = 1.4956298e-05
  estimated relative force accuracy = 1.0386574e-06
  KSpace vectors: actual max1d max3d = 257 5 665
                  kxmax kymax kzmax  = 5 5 5
Generated 0 of 6 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 15.83 | 15.83 | 15.83 Mbytes
   Step         TotEng         PotEng         KinEng          Temp          Press          E_pair         E_vdwl         E_coul         E_long         E_bond         Fnorm           Fmax          Volume    
         0  -635.44091     -675.09857      39.657659      1427          -20613.604     -675.09857      1.6320365      1018.8212     -1695.5518      0              3.0159619e-14  4.244001e-15   13990.5      
        50  -634.17349     -666.17818      32.004686      1151.6234     -4029.8408     -667.9562       37.809076      989.23282     -1694.9981      1.7780241      9.7133827      2.1917985      13990.5      
       100  -631.93518     -661.91228      29.977103      1078.6649     -3171.8049     -664.06721      39.333372      991.36936     -1694.7699      2.1549312      11.091442      2.1704391      13990.5      
       150  -630.16822     -663.12422      32.956001      1185.8545      143.2448      -665.48041      46.253732      982.97454     -1694.7087      2.3561821      11.46786       2.1651553      13990.5      
       200  -628.62231     -663.64931      35.026999      1260.3751     -1622.4417     -665.96886      41.661827      986.81674     -1694.4474      2.3195534      10.597705      2.9538092      13990.5      
       250  -627.31146     -662.01843      34.70697       1248.8596     -1509.7213     -664.5033       42.101576      987.90194     -1694.5068      2.4848605      10.39264       1.6933354      13990.5      
       300  -626.57661     -660.97478      34.398174      1237.7482     -1637.837      -663.48071      41.653234      989.53244     -1694.6664      2.5059266      11.20455       2.281493       13990.5      
       350  -625.91971     -665.35833      39.438621      1419.1184     -1351.5415     -667.61667      41.582396      985.53394     -1694.733       2.2583387      10.831513      1.8963892      13990.5      
       400  -625.24854     -660.77593      35.527394      1278.3808     -423.76056     -663.12573      43.89208       987.75061     -1694.7684      2.3497951      11.523557      2.1775968      13990.5      
       450  -624.6774      -662.88742      38.210024      1374.9098      1108.8746     -665.43264      46.964366      982.35221     -1694.7492      2.5452128      11.002171      2.001855       13990.5      
       500  -624.30223     -661.97987      37.677642      1355.7531     -998.22937     -664.60498      42.373559      987.58912     -1694.5677      2.6251097      11.151862      2.8272665      13990.5      
Loop time of 0.570078 on 4 procs for 500 steps with 432 atoms

Performance: 151.558 ns/day, 0.158 hours/ns, 877.074 timesteps/s, 378.896 katom-step/s
99.2% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.41998    | 0.4359     | 0.45943    |   2.2 | 76.46
Bond    | 0.00018011 | 0.00018983 | 0.0001966  |   0.0 |  0.03
Kspace  | 0.053293   | 0.075316   | 0.089619   |   4.9 | 13.21
Neigh   | 0.018392   | 0.018403   | 0.018416   |   0.0 |  3.23
Comm    | 0.035588   | 0.037076   | 0.038714   |   0.6 |  6.50
Output  | 0.00015364 | 0.00016291 | 0.00018814 |   0.0 |  0.03
Modify  | 0.001692   | 0.0017471  | 0.0018072  |   0.1 |  0.31
Other   |            | 0.00128    |            |       |  0.22

Nlocal:            108 ave         119 max         102 min
Histogram: 1 1 1 0 0 0 0 0 0 1
Nghost:           6516 ave        6545 max        6491 min
Histogram: 1 0 0 1 1 0 0 0 0 1
Neighs:        74338.5 ave       81249 max       69989 min
Histogram: 1 0 2 0 0 0 0 0 0 1

Total # of neighbors = 297354
Ave neighs/atom = 688.31944
Ave special neighs/atom = 1
Neighbor list builds = 22
Dangerous builds = 0

unfix thermoberendsen
unfix nve

fix npt_equ all npt temp 1427 1427 0.04 iso 0 0 0.4
fix_modify npt_equ temp CStemp press thermo_press_lmp # pressure for correct kinetic scalar

run 500
Ewald initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.17525654
  estimated absolute RMS force accuracy = 1.4956298e-05
  estimated relative force accuracy = 1.0386574e-06
  KSpace vectors: actual max1d max3d = 257 5 665
                  kxmax kymax kzmax  = 5 5 5
Generated 0 of 6 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 15.84 | 15.84 | 15.84 Mbytes
   Step         TotEng         PotEng         KinEng          Temp          Press          E_pair         E_vdwl         E_coul         E_long         E_bond         Fnorm           Fmax          Volume    
       500  -624.30211     -661.97987      37.677757      1355.7573     -998.22937     -664.60498      42.373559      987.58912     -1694.5677      2.6251097      11.151862      2.8272665      13990.5      
       550  -615.79632     -659.52755      43.731231      1573.5792      1469.9529     -662.38626      46.797338      985.55621     -1694.7398      2.8587126      11.811252      2.0393248      13960.728    
       600  -620.22767     -658.14705      37.919375      1364.4514     -1854.8309     -660.71608      40.181572      993.675       -1694.5727      2.5690334      10.392863      1.7393177      14315.468    
       650  -614.86385     -655.30959      40.445737      1455.3574      1451.8688     -658.21235      47.457361      988.94311     -1694.6128      2.9027561      12.822439      2.1572288      14252.453    
       700  -619.73566     -659.7229       39.987241      1438.8593      530.50529     -662.28877      45.409797      986.72372     -1694.4223      2.5658666      10.861237      1.9225875      14378.363    
       750  -616.63235     -654.72824      38.095891      1370.803      -28.121315     -657.80053      44.232836      992.73483     -1694.7682      3.0722896      11.700678      3.3373465      14715.044    
       800  -615.47254     -653.47071      37.998172      1367.2868     -245.65038     -655.94581      43.625009      995.01671     -1694.5875      2.4750969      11.504575      1.6466429      15114.13     
       850  -615.6431      -656.66232      41.019229      1475.9933     -683.01675     -659.15713      42.478686      993.1026      -1694.7384      2.4948081      11.245661      2.4521304      15259.427    
       900  -615.25284     -658.29519      43.042346      1548.7911     -168.21463     -660.87744      43.27133       990.3302      -1694.479       2.5822527      10.636735      1.644624       14828.706    
       950  -619.10322     -657.88977      38.786553      1395.655       958.0885      -660.52956      46.174002      987.90543     -1694.609       2.6397889      11.589187      1.9483069      14355.183    
      1000  -617.58969     -659.0462       41.456517      1491.7283      466.4389      -661.86016      44.811377      987.93058     -1694.6021      2.8139557      11.587056      2.2595277      14282.414    
Loop time of 0.606933 on 4 procs for 500 steps with 432 atoms

Performance: 142.355 ns/day, 0.169 hours/ns, 823.814 timesteps/s, 355.887 katom-step/s
99.3% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.40405    | 0.43395    | 0.47163    |   3.9 | 71.50
Bond    | 0.00027783 | 0.00032495 | 0.00035281 |   0.0 |  0.05
Kspace  | 0.059063   | 0.094432   | 0.1219     |   7.8 | 15.56
Neigh   | 0.021875   | 0.021908   | 0.02195    |   0.0 |  3.61
Comm    | 0.044194   | 0.046388   | 0.048703   |   0.7 |  7.64
Output  | 0.00014655 | 0.00015848 | 0.00019304 |   0.0 |  0.03
Modify  | 0.0076653  | 0.0078616  | 0.0080017  |   0.2 |  1.30
Other   |            | 0.00191    |            |       |  0.31

Nlocal:            108 ave         128 max         100 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           6420 ave        6578 max        6266 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Neighs:        72608.5 ave       84628 max       64334 min
Histogram: 1 0 0 2 0 0 0 0 0 1

Total # of neighbors = 290434
Ave neighs/atom = 672.30093
Ave special neighs/atom = 1
Neighbor list builds = 24
Dangerous builds = 0

unfix npt_equ

# ------------------------ Dynamic Run -------------------------------

fix npt_dyn all npt temp 1427 1427 0.04 iso 0 0 0.4
fix_modify npt_dyn temp CStemp press thermo_press_lmp # pressure for correct kinetic scalar
run 1000
Ewald initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.17518288
  estimated absolute RMS force accuracy = 1.5070246e-05
  estimated relative force accuracy = 1.0465707e-06
  KSpace vectors: actual max1d max3d = 257 5 665
                  kxmax kymax kzmax  = 5 5 5
Generated 0 of 6 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 15.84 | 15.84 | 15.84 Mbytes
   Step         TotEng         PotEng         KinEng          Temp          Press          E_pair         E_vdwl         E_coul         E_long         E_bond         Fnorm           Fmax          Volume    
      1000  -617.58968     -659.0462       41.456517      1491.7283      452.57214     -661.86016      44.811377      987.21959     -1693.8911      2.8139557      11.587056      2.2595277      14282.414    
      1050  -610.89565     -655.14478      44.249127      1592.2146      1053.3175     -658.05359      45.783622      989.96234     -1693.7996      2.9088168      11.984767      2.5382226      14495.445    
      1100  -615.42057     -654.22836      38.807787      1396.4191     -2085.1892     -656.53065      39.182621      998.41103     -1694.1243      2.3022837      9.9614227      2.4549217      15062.528    
      1150  -612.06047     -651.59811      39.537636      1422.6812      545.59531     -654.56993      45.472742      993.6803      -1693.723       2.9718192      11.753321      1.8294686      15075.974    
      1200  -609.69497     -649.44058      39.745615      1430.1649      1543.4252     -652.48972      47.777298      993.58644     -1693.8535      3.0491383      13.770496      2.2953272      15094.215    
      1250  -614.13576     -651.313        37.177246      1337.7474     -119.77364     -654.00029      44.162262      995.52071     -1693.6833      2.6872852      11.498305      1.9815253      15221.255    
      1300  -613.54639     -650.80809      37.261698      1340.7862      754.45957     -653.74685      46.18327       994.1074      -1694.0375      2.9387618      12.27142       2.9714048      15227.547    
      1350  -608.61221     -651.99421      43.381999      1561.0128     -414.00591     -654.73806      42.348361      996.70013     -1693.7866      2.7438496      11.605341      3.0269187      15373.46     
      1400  -615.31408     -652.38738      37.073301      1334.0072     -1053.0525     -655.20215      42.026413      996.74694     -1693.9755      2.8147661      11.034608      1.8193057      15586.435    
      1450  -609.00751     -653.07667      44.069159      1585.7388      372.69637     -655.81337      44.240633      993.87917     -1693.9332      2.7367026      11.360893      1.9605436      15451.368    
      1500  -611.76128     -652.5046       40.743321      1466.0653      793.53593     -655.4038       45.439207      993.23856     -1694.0816      2.8991999      10.401312      1.5964697      15278.275    
      1550  -618.40019     -653.96128      35.561085      1279.5932     -1725.3131     -656.80046      40.632924      996.31168     -1693.7451      2.8391835      10.963091      2.1785213      15405.047    
      1600  -613.11634     -652.99642      39.880072      1435.0031      1251.2255     -656.14121      46.939948      990.78878     -1693.8699      3.14479        12.767046      2.7619218      15049.424    
      1650  -618.04177     -654.71505      36.673282      1319.6133      529.17031     -657.63278      45.678743      990.56206     -1693.8736      2.9177358      11.721754      1.9313345      14690.4      
      1700  -618.93687     -658.86507      39.928198      1436.7348     -610.77491     -661.41289      42.718205      989.79591     -1693.927       2.5478293      10.859724      1.9579657      14443.195    
      1750  -625.4627      -661.29835      35.835648      1289.4727      496.36122     -663.93786      45.692476      984.20365     -1693.834       2.6395133      10.800782      1.8455393      13975.974    
      1800  -618.01832     -658.14399      40.125675      1443.8406      2350.9378     -661.30658      48.729613      983.78548     -1693.8217      3.1625892      12.178873      2.3272451      13474.98     
      1850  -620.83615     -659.15695      38.320803      1378.896       379.6884      -662.09651      45.114803      986.35964     -1693.5709      2.9395569      11.667397      2.0333381      13725.182    
      1900  -619.28128     -660.5105       41.22922       1483.5494      727.8766      -663.20061      45.648424      985.12873     -1693.9778      2.6901041      11.120778      1.9262622      14093.919    
      1950  -617.56718     -657.90942      40.342242      1451.6333     -639.82058     -660.321        42.491502      991.22874     -1694.0412      2.4115792      10.701213      1.9995563      14385.02     
      2000  -611.68615     -653.14778      41.461625      1491.912      -1229.9397     -656.00606      40.572796      997.33357     -1693.9124      2.85828        10.551962      1.5890034      14499.964    
Loop time of 1.18475 on 4 procs for 1000 steps with 432 atoms

Performance: 145.853 ns/day, 0.165 hours/ns, 844.057 timesteps/s, 364.632 katom-step/s
99.2% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.82692    | 0.85522    | 0.91177    |   3.6 | 72.19
Bond    | 0.00056228 | 0.00059867 | 0.00064892 |   0.0 |  0.05
Kspace  | 0.13487    | 0.18728    | 0.21573    |   7.2 | 15.81
Neigh   | 0.042186   | 0.042251   | 0.042308   |   0.0 |  3.57
Comm    | 0.077683   | 0.081789   | 0.086359   |   1.1 |  6.90
Output  | 0.0003369  | 0.00036826 | 0.00045948 |   0.0 |  0.03
Modify  | 0.014093   | 0.014232   | 0.014329   |   0.1 |  1.20
Other   |            | 0.003016   |            |       |  0.25

Nlocal:            108 ave         114 max         102 min
Histogram: 1 1 0 0 0 0 0 0 1 1
Nghost:           6340 ave        6390 max        6292 min
Histogram: 1 0 0 1 0 1 0 0 0 1
Neighs:        71686.5 ave       76457 max       67242 min
Histogram: 1 0 1 0 0 0 1 0 0 1

Total # of neighbors = 286746
Ave neighs/atom = 663.76389
Ave special neighs/atom = 1
Neighbor list builds = 48
Dangerous builds = 0
Total wall time: 0:00:02
