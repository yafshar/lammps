LAMMPS (12 Jun 2025 - Development - patch_12Jun2025-747-g3fabe8e766-modified)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
# sample LAMMPS input script for viscosity of 2d LJ liquid
# NEMD via fix deform and fix nvt/sllod

# settings

variable	x equal 20
variable	y equal 20

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

variable	srate equal 2.7 # velocity of top edge

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

# problem setup

lattice         sq2 ${rho}
lattice         sq2 0.6
Lattice spacing in x,y,z = 1.8257419 1.8257419 1.8257419
region          simbox prism 0 $x 0 $y -0.1 0.1 0.0 0.0 0.0
region          simbox prism 0 20 0 $y -0.1 0.1 0.0 0.0 0.0
region          simbox prism 0 20 0 20 -0.1 0.1 0.0 0.0 0.0
create_box      1 simbox
Created triclinic box = (0 0 -0.18257419) to (36.514837 36.514837 0.18257419) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
create_atoms    1 box
Created 800 atoms
  using lattice units in triclinic box = (0 0 -0.18257419) to (36.514837 36.514837 0.18257419) with tilt (0 0 0)
  create_atoms CPU = 0.000 seconds

pair_style      lj/cut ${rc}
pair_style      lj/cut 2.5
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287
velocity        all create 1 97287

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        2 all langevin 1 $t 0.1 498094
fix	        2 all langevin 1 1 0.1 498094
fix	        3 all enforce2d

# equilibration run

thermo          1000
run	        5000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.8
  ghost atom cutoff = 2.8
  binsize = 1.4, bins = 27 27 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton/tri
      stencil: half/bin/2d/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 3.058 | 3.058 | 3.058 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   1             -1.56492        0             -0.56617       -1.535262     
      1000   0.95906897    -1.571142       0             -0.61327189     0.82593948   
      2000   1.0164992     -1.6006146      0             -0.58538603     0.88642098   
      3000   1.0429232     -1.5801639      0             -0.53854441     1.157286     
      4000   1.0955206     -1.6156387      0             -0.52148756     0.94410567   
      5000   0.94117664    -1.6155061      0             -0.67550592     0.7935389    
Loop time of 0.926257 on 1 procs for 5000 steps with 800 atoms

Performance: 2331965.095 tau/day, 5398.067 timesteps/s, 4.318 Matom-step/s
99.6% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.37421    | 0.37421    | 0.37421    |   0.0 | 40.40
Neigh   | 0.1657     | 0.1657     | 0.1657     |   0.0 | 17.89
Comm    | 0.03253    | 0.03253    | 0.03253    |   0.0 |  3.51
Output  | 8.5322e-05 | 8.5322e-05 | 8.5322e-05 |   0.0 |  0.01
Modify  | 0.32595    | 0.32595    | 0.32595    |   0.0 | 35.19
Other   |            | 0.02778    |            |       |  3.00

Nlocal:            800 ave         800 max         800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            256 ave         256 max         256 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           5583 ave        5583 max        5583 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5583
Ave neighs/atom = 6.97875
Neighbor list builds = 551
Dangerous builds = 0

unfix  	        1
unfix		2

# turn on NEMD shear and equilibrate some more

velocity	all scale $t
velocity	all scale 1

# shear rate defined relative to perpendicular dimension

variable	xyrate equal ${srate}/ly
variable	xyrate equal 2.7/ly

fix		1 all nvt/sllod temp $t $t 0.1
fix		1 all nvt/sllod temp 1 $t 0.1
fix		1 all nvt/sllod temp 1 1 0.1
fix		2 all deform 1 xy erate ${xyrate} remap v
fix		2 all deform 1 xy erate 0.0739425452631974 remap v

compute         layers all chunk/atom bin/1d y center 0.05 units reduced
fix		4 all ave/chunk 20 250 5000 layers vx file profile.nemd.2d

compute		usual all temp
compute		tilt all temp/deform

thermo          1000
thermo_style	custom step temp c_usual epair etotal press pxy
thermo_modify	temp tilt
run		50000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 3.324 | 3.324 | 3.324 Mbytes
   Step          Temp         c_usual         E_pair         TotEng         Press           Pxy      
      5000   2.2053153      1.0028072     -1.6155061      0.58705255     1.551074      -0.031206833  
      6000   0.93932838     1.111554      -1.6835535     -0.74539929     0.59260967    -0.12445278   
      7000   1.0178328      1.1944108     -1.6691749     -0.65261437     0.79914255    -0.20159759   
      8000   0.95998747     1.2055327     -1.6776903     -0.71890279     0.62744493    -0.063667458  
      9000   0.98987003     1.250254      -1.6954804     -0.7068477      0.70695957     0.039603145  
     10000   0.97431114     1.2647346     -1.6670223     -0.69392903     0.74682008     0.0080468679 
     11000   0.97568984     1.3051131     -1.6626017     -0.68813147     0.85506743    -0.11561384   
     12000   0.99246259     1.3446583     -1.669781      -0.67855895     0.56296852    -0.039866126  
     13000   0.98136205     1.4261424     -1.685419      -0.70528368     0.80846426    -0.12270554   
     14000   1.0150906      1.4541216     -1.6437535     -0.62993176     0.83380718     0.0022616398 
     15000   0.99152359     1.4582955     -1.6466242     -0.65634005     0.89335497    -0.13004875   
     16000   1.0344559      1.4988334     -1.6139918     -0.58082888     0.88071966    -0.11990446   
     17000   0.98174322     1.5222947     -1.6684511     -0.6879351      0.7937666     -0.092577965  
     18000   0.9978408      1.5250795     -1.6445705     -0.64797703     0.85149623    -0.25898296   
     19000   1.0308912      1.5491006     -1.6011731     -0.57157051     0.95865078    -0.25199222   
     20000   1.0241357      1.6181025     -1.6217317     -0.59887618     0.93802007    -0.020187756  
     21000   0.92408476     1.5566149     -1.6288307     -0.70590104     0.94404931    -0.25991036   
     22000   0.9689518      1.602114      -1.652448      -0.68470739     0.77634579    -0.019863831  
     23000   1.05198        1.694163      -1.6345389     -0.58387391     0.94524078    -0.05348712   
     24000   1.0352301      1.6295794     -1.5744938     -0.54055769     1.2570938     -0.29236874   
     25000   0.93073182     1.5805024     -1.6181052     -0.6885368      0.98615731    -0.19925347   
     26000   1.0047392      1.6260106     -1.625771      -0.62228769     0.80560337    -0.085987396  
     27000   0.97439068     1.6334514     -1.60027       -0.6270973      0.89784202     0.036317419  
     28000   1.0489259      1.683851      -1.6215224     -0.5739076      0.77837861    -0.094348688  
     29000   1.0259079      1.7302715     -1.6230434     -0.59841787     0.97088772    -0.053416712  
     30000   0.98759751     1.6964369     -1.6532393     -0.66687633     0.79179235     0.048323115  
     31000   0.99881031     1.7839797     -1.6148336     -0.6172718      0.88129696    -0.17934702   
     32000   0.98973737     1.7770867     -1.6193975     -0.6308973      0.78646689    -0.19084319   
     33000   1.0173173      1.7931322     -1.6127335     -0.59668784     0.84426484    -0.13682577   
     34000   0.97168892     1.7593242     -1.56386       -0.59338567     1.1571592     -0.034219662  
     35000   0.98347352     1.7763424     -1.6122953     -0.63005114     0.9247021     -0.037261552  
     36000   0.99261691     1.8139015     -1.6104995     -0.61912341     1.0444079     -0.11189581   
     37000   0.99493001     1.8212918     -1.5506832     -0.55699688     1.0918733     -0.18271766   
     38000   0.97663854     1.8280603     -1.5895182     -0.61410046     0.91804558    -0.21539366   
     39000   0.96235164     1.8281385     -1.60295       -0.6418013      0.74826303    -0.097736456  
     40000   1.0057532      1.8330454     -1.5980661     -0.59357012     0.78156546    -0.33197611   
     41000   0.96674261     1.8223728     -1.596254      -0.63071983     0.91060189    -0.097869502  
     42000   1.0144494      1.8547666     -1.5664128     -0.55323143     1.2734409     -0.19102823   
     43000   1.0245435      1.8696313     -1.584056      -0.56079317     1.0582403     -0.1859025    
     44000   1.0272122      1.9589066     -1.5829934     -0.5570652      1.146554      -0.15243983   
     45000   1.0407481      1.964914      -1.5834463     -0.5439992      1.0655317     -0.0055178332 
     46000   0.97484423     1.8695001     -1.5621762     -0.58855055     1.2409689     -0.23129108   
     47000   1.0212627      1.9794062     -1.5812353     -0.56124923     1.0028285     -0.06600236   
     48000   0.93786952     1.9193023     -1.5874216     -0.65072441     0.87547065    -0.090027262  
     49000   0.99836148     1.9395952     -1.6494062     -0.65229268     0.80928685     0.022881246  
     50000   1.0464414      1.9467567     -1.559195      -0.51406163     1.1653312     -0.10101184   
     51000   1.0023517      1.9526996     -1.5819008     -0.580802       0.96918188    -0.0096584728 
     52000   0.99697671     1.993883      -1.5997093     -0.60397879     0.84184935    -0.023961204  
     53000   0.96507234     1.9477939     -1.609129      -0.64526298     1.0513457     -0.07804176   
     54000   1.0739239      2.0894499     -1.591502      -0.5189205      0.96930909    -0.043170285  
     55000   0.94478604     1.9125314     -1.5761932     -0.63258817     1.1217031     -0.27445338   
Loop time of 13.8562 on 1 procs for 50000 steps with 800 atoms

Performance: 1558870.414 tau/day, 3608.496 timesteps/s, 2.887 Matom-step/s
99.6% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.0296     | 4.0296     | 4.0296     |   0.0 | 29.08
Neigh   | 3.4293     | 3.4293     | 3.4293     |   0.0 | 24.75
Comm    | 0.4777     | 0.4777     | 0.4777     |   0.0 |  3.45
Output  | 0.0022525  | 0.0022525  | 0.0022525  |   0.0 |  0.02
Modify  | 5.5308     | 5.5308     | 5.5308     |   0.0 | 39.92
Other   |            | 0.3866     |            |       |  2.79

Nlocal:            800 ave         800 max         800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            274 ave         274 max         274 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           5622 ave        5622 max        5622 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5622
Ave neighs/atom = 7.0275
Neighbor list builds = 11301
Dangerous builds = 0

# data gathering run

variable	visc equal -pxy/(v_srate/ly)
fix		vave all ave/time 10 100 1000 v_visc ave running start 56000

thermo_style	custom step temp press pxy v_visc f_vave
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify	temp tilt

# only need to run for 5400 steps to make a good 100-frame movie
# set 54K steps above in equil and 5400 here simply to make good movie
# 54K and 5400 are multiples of box-swap periodicity = 2700 steps

#dump	        1 all custom 50 dump.nemd.2d id type x y z vx

#dump		2 all image 50 image.*.jpg vx type zoom 1.2 adiam 1.2
#dump_modify	2 pad 5 amap 0.0 ${srate} ca 0.0 2 min blue max red

run		50000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 3.333 | 3.333 | 3.333 Mbytes
   Step          Temp          Press           Pxy           v_visc         f_vave    
     55000   0.94478604     1.1238902     -0.27678364     3.7432258      0            
     56000   0.98471117     0.92161885    -0.13445967     1.8184344      1.2593019    
     57000   1.0068197      1.1271632     -0.14398034     1.9471921      1.0231582    
     58000   1.0030551      0.84290436    -0.02370293     0.32055876     1.1450123    
     59000   1.0415745      0.91270421    -0.019806667    0.26786564     1.1389212    
     60000   1.0351048      1.2303386     -0.14932562     2.0194818      1.2666619    
     61000   0.99339615     0.87911226    -0.13627252     1.8429515      1.2338826    
     62000   1.0548357      1.0756218     -0.0078129124   0.10566193     1.2697405    
     63000   1.0128167      0.93169313     0.048147143   -0.65114263     1.3023082    
     64000   1.050889       0.90995384    -0.024358618    0.32942629     1.2608971    
     65000   0.99421749     1.0413474     -0.069121831    0.93480459     1.2203519    
     66000   1.0029338      0.91040507    -0.049148626    0.66468669     1.1974243    
     67000   0.97018723     1.0350754     -0.21999423     2.975205       1.2174781    
     68000   1.0115771      1.0331454     -0.20725559     2.8029274      1.2098482    
     69000   0.9417175      1.0272668      0.056680813   -0.76655209     1.2053586    
     70000   1.0216282      1.1087095     -0.11803931     1.5963653      1.233954     
     71000   0.98411628     0.84679104    -0.081074649    1.0964547      1.2234166    
     72000   1.0103494      0.93158706    -0.15459153     2.090698       1.2371752    
     73000   1.0262836      0.85556703    -0.17676291     2.390544       1.2262517    
     74000   1.0397904      1.0337674     -0.12303752     1.6639611      1.2456784    
     75000   0.99506605     0.66246546    -0.033883614    0.45824246     1.2434476    
     76000   1.0102973      0.90850044    -0.020837202    0.28180261     1.2584778    
     77000   0.9654875      0.96658128    -0.11549009     1.5618896      1.2877205    
     78000   0.99650808     0.9992766     -0.03062805     0.41421417     1.2945715    
     79000   0.97733949     0.96630977    -0.025251799    0.34150567     1.2750132    
     80000   0.99403958     1.0100573     -0.26185458     3.541325       1.2787338    
     81000   1.0627534      1.0820528     -0.15472842     2.0925493      1.2696308    
     82000   0.97500546     1.2209752     -0.0054306042   0.073443566    1.2645412    
     83000   0.96675251     0.97629108    -0.052948678    0.71607865     1.2550421    
     84000   0.97117651     1.2362265     -0.14104954     1.907556       1.2601553    
     85000   1.0569968      0.93447759    -0.13872425     1.8761087      1.2551291    
     86000   1.0175905      0.93192701    -0.036594718    0.49490746     1.2557842    
     87000   0.98385722     0.82984797    -0.044452627    0.60117794     1.2506764    
     88000   0.9918417      0.98817015    -0.027577808    0.37296265     1.2444347    
     89000   1.0142515      1.0532365     -0.012583897    0.1701848      1.239019     
     90000   1.0447697      0.97913157    -0.21499832     2.9076402      1.2422019    
     91000   0.99078451     1.1429234     -0.29032176     3.9263155      1.2410364    
     92000   1.0117308      1.0857197     -0.078539797    1.0621733      1.2354094    
     93000   0.99691597     1.1309168     -0.11415737     1.5438658      1.2312192    
     94000   0.98897936     0.9491594     -0.19853762     2.6850255      1.2294409    
     95000   1.0284878      0.95631625     0.011944394   -0.16153615     1.2161582    
     96000   1.0138165      1.0464932     -0.0074369833   0.10057786     1.207883     
     97000   1.0294918      0.83850195    -0.12627331     1.7077219      1.2066508    
     98000   0.93722985     1.0067744     -0.088953708    1.2030112      1.2082885    
     99000   0.97518063     1.0426117     -0.096959246    1.3112782      1.2023331    
    100000   1.0479815      1.1181966     -0.085524114    1.1566293      1.2022117    
    101000   0.96062242     1.1284496     -0.1174758      1.5887443      1.1986323    
    102000   1.0304762      1.0987225     -0.084863823    1.1476995      1.1957421    
    103000   0.99537921     1.1002848     -0.034382757    0.46499288     1.1951235    
    104000   0.97399904     1.0827774      0.031297715   -0.42327073     1.1935171    
    105000   0.97899326     0.98854425    -0.24339048     3.2916162      1.1927835    
Loop time of 14.4975 on 1 procs for 50000 steps with 800 atoms

Performance: 1489913.139 tau/day, 3448.873 timesteps/s, 2.759 Matom-step/s
99.5% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.2229     | 4.2229     | 4.2229     |   0.0 | 29.13
Neigh   | 3.7229     | 3.7229     | 3.7229     |   0.0 | 25.68
Comm    | 0.50543    | 0.50543    | 0.50543    |   0.0 |  3.49
Output  | 0.0012909  | 0.0012909  | 0.0012909  |   0.0 |  0.01
Modify  | 5.6351     | 5.6351     | 5.6351     |   0.0 | 38.87
Other   |            | 0.4099     |            |       |  2.83

Nlocal:            800 ave         800 max         800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            271 ave         271 max         271 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           5585 ave        5585 max        5585 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5585
Ave neighs/atom = 6.98125
Neighbor list builds = 12290
Dangerous builds = 0
Total wall time: 0:00:29
